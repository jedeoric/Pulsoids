'Pulsoids (English version)

:LEV01
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A120880]	'["R-GB  BG-R"]
:LEV02
[3F3F3F121212123F3F3F]	'["   ----   "]
[3F3F1414121214143F3F]	'["  ++--++  "]
[3F0C0814141414080C3F]	'[" BB++++BB "]
[3F0A0A081414080A0A3F]	'[" GGB++BGG "]
[3F0C0A0A08080A0A0C3F]	'[" RGGBBGGR "]
[3F0C0C0A0A0A0A0C0C3F]	'[" RRGGGGRR "]
[3F3F0C0C0A0A0C0C3F3F]	'["  RRGGRR  "]
[3F3F3F0C0C0C0C3F3F3F]	'["   RRRR   "]
[3F3F3F3F0C0C3F3F3F3F]	'["    RR    "]
[3F3F3F3F0C0C3F3F3F3F80]	'["    RR    "]
:LEV03
[0A0A0A260A0A260A0A0A]	'["GGGWGGWGGG"]
[161616263F3F26141414]	'["---W  W+++"]
[161616263F3F26141414]	'["---W  W+++"]
[161604263F3F26141414]	'["--LW  W+++"]
[080808263F3F26080808]	'["RRRW  WRRR"]
[141414203F3F20161616]	'["+++W  W---"]
[141414263F3F26161616]	'["+++W  W---"]
[141414263F3F26161616]	'["+++W  W---"]
[0A0A0A260A0A260A0A0A80]	'["GGGWGGWGGGX"]
:LEV04
[1212123F3F3F3F121212]	'["+++    +++"]
[1616123F3F3F3F121616]	'["--+    +--"]
[1616123F3F3F3F120416]	'["--+    +L-"]
[1616123F3F3F3F121616]	'["--+    +--"]
[1616123F3F3F3F121616]	'["--+    +--"]
[1616123F3F3F3F121616]	'["--+    +--"]
[16161212121212121616]	'["--++++++--"]
[08080808080808080808]	'["BBBBBBBBBB"]
[0A0A0A0A0A0A0A0A0A0A]	'["GGGGGGGGGG"]
[0C0C0C0C0C0C0C0C0C0C80]	'["RRRRRRRRRRX"]
:LEV05
[3F3F3F3F3F3F3F3F3F08]	'["         B"]
[3F3F3F3F3F3F3F3F0808]	'["        BB"]
[3F3F063F3F3F3F080808]	'["  L    BBB"]
[3F3F3F3F3F3F0A0A0A0A]	'["      GGGG"]
[3F3F3F3F3F0A0A0A0A0A]	'["     GGGGG"]
[3F3F3F3F101010101010]	'["    ++++++"]
[3F3F3F10101010101010]	'["   +++++++"]
[3F3F0808080808080808]	'["  BBBBBBBB"]
[3F080808080808080808]	'[" BBBBBBBBB"]
[0C0C0C0C0C0C0C0C0C0C80]	'["RRRRRRRRRRX"]
:LEV06
[08080808080808080808]	'["BBBBBBBBBB"]
[0A0A0A3F3F3F3F0A020A]	'["GGG    GLG"]
[0A0A3F3F12123F3F0A0A]	'["GG  ++  GG"]
[0A3F3F121212123F3F0A]	'["G  ++++  G"]
[3F3F1414161614143F3F]	'["  ++--++  "]
[3F3F1414161614143F3F]	'["  ++--++  "]
[0A3F3F121212123F3F0A]	'["G  ++++  G"]
[0A0A3F3F12123F3F0A0A]	'["GG  ++  GG"]
[0A0A0A3F3F3F3F0A020A]	'["GGG    GLG"]
[08080808080808080808]	'["BBBBBBBBBB"]
[0C0C0C0C0C0C0C0C0C0C80]	'["RRRRRRRRRRX"]
:LEV07
[3F003F3F10103F3F003F]
[3F3F3F101010103F3F3F]
[3F3F1010080810103F3F]
[3F1010080A0A0810103F]
[1010080A1A1A0A081010]
[0C080A1A1A1A1A0A080C]
[0C080A1A1A1A1A0A080C]
[0C0C0C0C1A1A0C0C0C0C]
[3F3F3F0C1A1A0C3F3F3F]
[3F3F3F0C0C0C0C3F3F3F80]
:LEV08
[0A0A262626263F3F3F3F]
[0A0A263F3F263F3F3F3F]
[0A02263F3F263F3F3F3F]
[2626263F3F263F3F3F3F]
[3F3F3F3F3F263F3F3F3F]
[3F3F3F3F3F263F3F3F3F]
[0C0C262626260C0C0C0C]
[14142614141414141414]
[14142614141414141414]
[08080808080826262626]
[0808080808080808080880]
:LEV09
[262626220C080C241008]
[0226180A0C0A0C0C0810]
[18260A0A0C080C0C1008]
[0A2618260C0A0C260810]
[180A0A26142614261008]
[0A0A180C2614260C0820]
[180A0A0C260C260C2608]
[0A0A181A0A080A1A2610]
[180A0A0C1A0C1A0C2608]
[0A0A18140C1A0C142610]
[08080808080808080808]
[0A0A0A0A0A0A0A0A0A0A80]
'
'[3F3F3F3F3F3F3F3F3F3F]
'[3F3F3F3F3F3F3F3F3F3F]
'[261A1A0A0A1A1A080812]
'[1A1A0A001A1A08081212]
'[1A0A0A1A1A080812120C]
'[0A0A1A1A080812120C0C]
'[201A1A080812120C0C14]
'[1A1A080812120C0C1414]
'[1A080812120C0C14142680]
:LEV10
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[0C0C0C26262626260C0C]
[10101010101010101010]
[0A020A0A0A0A0A0A0A0A]
[0C0C262626260C0C0C0C]
[10101010101010101010]
[08080808080808080808]
[0C2626260C0C0C0C0C0C80]
:LEV11
[0C0C2626262626260C0C]
[0A0A0810101010260A0A]
[0A0A0810101010260A0A]
[3F3F3F26262626263F3F]
[3F3F3F261A1A1A083F3F]
[3F3F3F261A1A1A083F3F]
[3F3F3F26262626263F3F]
[0A0A0810101010260A0A]
[0A0A0810101010260A0A]
[0C0C0C26262626260C0C80]
:LEV12
[3F3F1A1A3F3F1A1A3F3F]
[3F1A1A1A3F3F1A1A1A3F]
[1A1A1A1A3F3F1A1A1A1A]
[0A0A080C3F3F020A080C]
[0A080C083F3F0A080C08]
[080C080A3F3F080C080A]
[0C080A0A3F3F0C080A0A]
[121212123F3F1414141480]
:LEV13
[3F3F3F0C0C0C0C3F3F3F]
[3F3F0C0C0C0C0C0C3F3F]
[3F0C0C0A0A0A0A0C0C3F]
[0C0C0A0A0A0A0A0A0C0C]
[3F3F1A1A1A1A1A1A3F3F]
[3F3F1A1A1A1A1A1A3F3F]
[3F3F2626060426263F3F]
[3F3F1212121212123F3F]
[3F3F1212121212123F3F]
[08080808080808080808]
[0808080808080808080880]
:LEV14
[0C0C0C0C0C0C0C0C0C0C]
[160C163F3F3F0C161616]
[160C160C3F3F0C160216]
[160C160C3F060C161616]
[0C0C120C0C0C0C0C0C0C]
[120C120C3F3F0C121212]
[120C120C3F3F0C121212]
[120C120C3F3F0C121212]
[0C2612260C0C0C0C0C0C80]
:LEV15
[0A0A0A0A0A3F3F3F3F3F]
[262626260A1414141414]
[3F3F3F260A1426262626]
[3F3F3F260A14263F3F3F]
[3F3F3F260A14263F3F3F]
[0C0C0C260A14263F3F3F]
[181818260A14260C0C0C]
[181818260A1426181818]
[080808260A1426181818]
[14141414141426080808]
[3F3F3F3F0A0A0A0A0A0A80]
:LEV16
[06000600060006000600]
[08080808080808080808]
[0A0A0A0A0A0A0A0A0A0A]
[0A0A0A0A0A0A0A0A0A0A]
[0C0C0C0C0C0C0C0C0C0C]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[16161616161616161616]
[12121212121212121212]
[1212121212121212121280]
:LEV17
[0C08080808080808080C]
[263F3F3F3F08020A1226]
[263F0C3F080A0A121226]
[263F3F080A0A12120A26]
[263F080A0A12120A0A26]
[26080A0A12120A0A0826]
[260A0A12120A0A083F26]
[260A12120A0A083F3F26]
[2612120A0A083F3F3F26]
[26120A0A083F3F3F3F26]
[2608080808080808082680]
:LEV18
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F08083F3F3F3F]
[3F3F3F080808083F3F3F]
[3F3F08080A0208083F3F]
[3F08080A0A0A0A08083F]
[08080A0A0A0A0A0A0808]
[081414143F3F1A1A1A08]
[1414143F3F3F3F1A1A1A]
[14143F3F3F3F3F3F1A1A]
[143F3F3F3F3F3F3F3F1A]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[0C0C0C0C0C0C0C0C0C0C80]
:LEV19
[16161616161616161616]
[16161616161616161616]
[16161616161616161616]
[0A0A0A0A0A0A0A0A0A0A]
[0A0A020A0A0A0A0A0A0A]
[0C0C0C0C0C0C0C0C0C0C]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[10101010101010101010]
[10101010101010101010]
[1010101010101010101080]
:LEV20
[0C0C0C0C26260C0C0C0C]
[180A180A26260A120A12]
[0A180A182626120A120A]
[180A180A26260A120A12]
[02180A182626120A120A]
[180A180A26260A120A12]
[0A180A182026120A120A]
[0C0C0C0C26260C0C0C0C]
[08080808080808080808]
[0808080808080808080880]
:LEV21
[0C0C0C0C0C0C0C0C0C0C]
[0A0A0A0A0A0A0A0A0A02]
[1E0A0A0A0A0A0A0A0A0A]
[3F080808080808080808]
[3F3F0808080808080808]
[3F3F3F14141414141414]
[3F3F3F3F141414141414]
[3F3F3F3F3F0A0A0A0A0A]
[3F3F3F3F3F3F1A1A1A1A]
[3F3F3F3F3F3F3F1A1A1A]
[3F3F3F3F3F3F3F3F1A1A]
[3F3F3F3F3F3F3F3F3F1A80]
:LEV22
[00120A0C3F3F0C0A1200]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[00120A0C3F3F0C0A1200]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[00120A0C3F3F0C0A1200]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[08120A0C3F3F0C0A1208]	'["R-GB  BG-R"]
[0C0C0C0C3F3F0C0C0C0C80]	'["BBBB  BBBBX"]
:LEV23
[1A1A1A1A1A1A1A1A1A1A]
[0C26261A1A1A1A26260C]
[0A26080812120808260A]
[0C26080C12120C08260C]
[0A26080812120808260A]
[0C26080C12120C08260C]
[0A26080812120808260A]
[0C26080C12120C08260C80]
:LEV24
[10101010262610101010]
[101010103F3F10101010]
[101010103F3F10101010]
[0C0C0C0C3F3F0C0C0C0C]
[2222220A3F3F22222222]
[220A00223F3F220A0A0A]
[220A0A223F3F220A0A0A]
[220A0A223F3F22220A0A]
[220808223F3F22080808]
[220808223F3F22080808]
[220802223F3F22080808]
[222222083F3F2208080880]
:LEV25
[3F0A260A26260A260A3F]
[260A260A0A0A0A260A26]
[0A0A080A0A0A0A080A0A]
[0A083F080A0A083F080A]
[0A0A080A0A0A0A080A0A]
[0A0A0A0A0C0C0A0A0A0A]
[0A0A0A0A0C0C0A0A0A0A]
[0A020A0A0A0A0A0A020A]
[0A12120A0A0A0A12120A]
[0A0A1212121212120A0A]
[3F0A0A121212120A0A3F]
[3F3F0A0A0A0A0A0A3F3F80]
:LEV26
[0C0C0C0C0C0C3F3F3F1C]
[0A020A0C0A0A0A0A3F3F]
[3F3F3F0C10101010103F]
[3F3F3F0C101010101010]
[3F3F3F0C262626262626]
[3F3F3F0C101010101010]
[3F3F3F0C10101010103F]
[0A020A0C0A0A0A0A3F3F]
[0C0C0C0C0C0C3F3F3F3F80]
:LEV27
[3F3F3F3F3F3F3F3F3F3F]
[3F121212120A0A020A3F]
[3F122626260A1826123F]
[3F122618180A1826123F]
[3F1226180A0A1826123F]
[3F1226180A0A1826123F]
[3F1226180A0A1826123F]
[3F1226180A0A1826123F]
[3F1226180A181826123F]
[3F1226180A262626123F]
[3F0A0A0A0A121212123F80]
:LEV28	'NEW LEVEL
[0C0C0C263F3F260C0C0C]
[1A101A263F3F261A101A]
[101A10263F3F26101A10]
[1A101A263F3F261A101A]
[101A10263F3F26101A10]
[262626260C0C26262626]
[060208263F3F26080206]
[0A0A0A263F3F260A0A0A]
[080808083F3F08080808]
[141414143F3F14141414]
[181818183F3F18181818]
[0C0C0C0C0C0C0C0C0C0C80]
:LEV29
[1E08081A1A1A08080812]
[08081A1A1A0808081212]
[081A1A1A08000812120C]
[1A1A1A08080812120C0C]
[1A1A08000812120C0C3F]
[1A08080812120C0C3F3F]
[08000812120C0C3F3F3F]
[080812120C0C3F3F3F3F]
[0812120C0C3F3F3F3F3F]
[12120C0C3F3F3F3F3F3F]
[120C0C3F3F3F3F3F3F3F]
[0C0C3F3F3F3F3F3F3F3F]
[0C3F3F3F3F3F3F3F3F3F80]
:LEV30
[0C0C0C262626260C0C0C]
[0C0C0C263F3F260C0C0C]
[0C0C0C263F3F260C0C0C]
[0A0A0A261A1A260A0A0A]
[0A0A0A261A1A260A0A0A]
[0A0A0A261212260A0A0A]
[0A0A0A261212260A0A0A]
[08080826121226080808]
[08080826121226080808]
[2008082612122608080880]
:LEV31
[3F3F3F3F3F3F3F3F3F3F]
[26020202020202020226]
[26260202020202020226]
[26262602020202022626]
[260A0A0A0A0A0A262626]
[260A0A0A0A0A0A0A0A26]
[100C100C100C100C100C]
[0C100C100C100C100C10]
[100C100C100C100C100C]
[0C100C100C100C100C10]
[3F3F3F3F3F3F3F3F3F3F]
[0C0C0C0C0C0C0C0C0C0C80]
:LEV32
[00140014001400140014]
[26262626262626263F26]
[26080808080808080826]
[0C080808080808080826]
[0C0C2626262626262026]
[0C103F3F3F3F3F3F1026]
[26103F3F3F3F3F3F1026]
[26262626262626260C26]
[22222222222222222222]
[12121212121212121212]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[0C0C0C0C0C0C0C0C0C0C80]
:LEV33
[223F3F262626263F0222]
[3F3F26260C0C26263F3F]
[3F3F263F3F023F263F3F]
[3F3F263F12123F263F3F]
[3F3F263F12123F263F3F]
[3F3F0C3F02023F0C3F3F]
[3F3F263F12123F263F3F]
[3F3F263F12123F263F3F]
[3F3F263F023F3F263F3F]
[3F3F26260C0C26263F3F]
[3F3F3F262626263F3F3F]
[223F023F3F3F3F3F3F22]
[3F08080808080808083F80]
:LEV34
[3F3F3F3F1C1C3F3F3F3F]
[260C260C26260C260C26]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F0C3F0C3F3F0C3F0C3F]
[3F263F263F3F263F263F]
[3F3F3F3F3F3F3F3F3F3F]
[3F263F263F3F263F263F]
[1414141414141414141480]
:LEV35
[003F3F3F3F3F3F3F3F00]
[262626263F3F26262626]
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F3F]
[08263F261010263F2608]
[08263F261010263F2608]
[08263F261010263F2608]
[08263F261010263F2608]
[262604262626260C2626]
[3F3F3F3F26263F3F3F3F]
[1010101010101010101080]
:LEV36
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F003F3F003F3F3F]
[1212263F26263F261212]
[1212263F3F3F3F261212]
[0C0C263F26263F260C0C]
[1212263F26263F261212]
[1212263F26263F261212]
[1402263F3F3F3F260214]
[2626263F26263F262626]
[3F3F263F26263F263F3F]
[3F3F263F26263F263F3F]
[3F3F263F26263F263F3F80]
:LEV37
'Flag:
[0C08080800220808080C]
[260C0808080808080C26]
[0C160C080808080C140C]
[2616160C08080C141426]
[0C1616160C0C1414140C]
[26161616262614141426]
[0C1616160C0C1414140C]
[26161616262614141426]
[0C1616160C0C1414140C]
[080C1616262614140C08]
[08080C160C0C140C0808]
[0808080C26260C08080880]
:LEV38
[0C0C3F0C0C0C0C3F0C0C]
[0C023F0C12120C3F020C]
[0C263F0C12120C3F260C]
[0C263F0C12120C3F260C]
[0C023F0C12120C3F020C]
[0C3F3F0C12120C3F3F0C]
[0C3F3F0C12120C3F3F0C]
[0C3F0C121A1A120C3F0C]
[0C3F0C121A1A120C3F0C]
[0C3F0C121A1A120C3F0C]
[0C3F0C121A1A120C3F0C]
[0C3F0C121A1A120C3F0C]
[0C3F0C121A1A120C3F0C80]
:LEV39
'NASA
[3F3F3F0C1C1E0C3F3F3F]
[3F3F0C0C3F3F0C0C3F3F]
[3F0C0C3F3F3F3F0C0C3F]
[0C0C3F3F18183F3F0C0C]
[0C0C3F183F3F183F0C0C]
[0C0C183F12123F180C0C]
[0C0C3F123F3F123F0C0C]
[0C0C123F18183F120C0C]
[0C0C3F183F3F183F0C0C]
[0C0C183F12123F180C0C]
[0C0C3F122626123F0C0C]
[0C0C1226262626120C0C]
[3F0C0C0C3F3F0C0C0C3F80]
'Arrows:
:LEV40
[0C0C0C0C0C0C0C0C0C0C]
[141418140C0C18141818]
[141818140C0C18141418]
[181818180C0C14141414]
[141818140C0C18141418]
[141418140C0C18141818]
[0C0C0C0C0C0C0C0C0C0C]
[3F3F3F3F3F3F3F3F3F3F]
[263F263F263F263F263F]
[263F263F263F263F263F]
[263F263F263F263F263F]
[3F0C3F0C3F0C3F0C3F0C]
[3F0C3F0C3F0C3F0C3F0C]
[3F0C3F0C3F0C3F0C3F0C80]

:LEV41
'Strange:
[26082608260826082608]
[260C26042602260C260C]
[3F3F3F3F3F3F3F3F3F3F]
[2608263F263F263F263F]
[263F2608263F263F263F]
[263F263F2608263F263F]
[263F263F263F2608263F]
[3F3F3F3F3F3F3F3F3F08]
[263F263F263F2608263F]
[263F263F2608263F263F]
[263F2608263F263F263F]
[3F08263F263F263F3F3F]
[3F3F3F3F263F3F3F3F3F80]
:LEV42	'FREECELL
[1E260C262626260C261E]
[0C26121226060410260C]
[3F26262626262626263F]
[3F26020A0626000A263F]
[3F260C262626260C263F]
[3F0C3F3F3F3F3F3F0C3F]
[3F260C262626260C263F]
[3F261E1226060410263F]
[3F26262626262626263F]
[3F26020A0C261E0A263F]
[3F260C262626260C263F]
[3F3F3F3F3F3F3F3F3F3F]
[221C221C221C221C221C80]
:LEV43
'Ball:
[003F3F3F3F3F3F3F3F00]
[3F3F3F3F3F3F3F3F3F3F]
[1C3F3F3F0C1A3F3F3F1C]
[3F063F0C1A140A3F063F]
[3F3F0C1A14040A0A3F3F]
[3F0C1A140A0A0A0C1A3F]
[0C1A140A0A0A0C1A140C]
[3F140A0A040C1A140C3F]
[3F3F0A0A0C1A140C3F3F]
[3F063F0C1A140C3F063F]
[1C3F3F3F140C3F3F3F1C80]
:LEV44
[3F263F3F3F3F3F3F0A3F]
[263F263F3F3F3F0A040A]
[263F263F3F3F3F0A060A]
[3F263F26263F3F3F0A3F]
[3F3F3F263F263F3F3F3F]
[083F0826263F3F0A0A0A]
[083F08263F263F0A0A3F]
[083F083F3F3F260A3F3F]
[3F083F3F3F3F260A0A0A]
[3F3F3F3F3F3F263F3F3F]
[083F083F3F3F263F2626]
[0808083F3F3F3F263F3F]
[083F083F3F3F3F263F3F]
[083F083F3F3F3F3F262680]
:LEV45
'Snail:
[3F3F3F3F3F3F3F3F3F3F]
[3F3F3F3F3F3F3F3F3F0C]
[3F3F3F3F3F3F3F3F3F1E]
[3F260C0C263F3F3F3F0C]
[263F3F3F3F263F3F3F1C]
[263F08003F263F3F3F0C]
[263F00083F263F3F3F1E]
[263F3F3F3F263F3F3F0C]
[3F262626263F3F3F3F1C]
[3F3F3F3F3F3F3F3F3F0C]
[3F3F3F3F3F3F3F3F3F0C]
[3F3F3F3F3F3F3F3F3F0C80]
:LEV46
'The Wall:
[3F263F3F3F3F3F3F3F3F]
[3F0C3F3F3F3F3F3F3F3F]
[3F263F3F3F0A0A3F3F3F]
[3F263F3F0A0A0A0A3F3F]
[3F263F0A0A0C0C0A0A3F]
[3F263F3F0A0A0A0A3F3F]
[3F263F3F3F0A0A3F3F3F]
[3F263F3F3F3F3F3F3F3F]
[3F263F3F3F3F3F3F3F3F]
[3F262626262626262626]
[3F3F3F12121212121212]
[3F3F3F26262626262626]
[3F3F3F3F3F3F12121212]
[3F3F3F3F3F262626262680]
:END_NOTE
["THIS IS TWILIGHTE CODE... BUILT TO CONFUSE THE LIVING DAYLIGHTS OUT OF YOU!"]
:LEV47
'Maximum 10*14
'00 Red L   10 Red +     1E Blu Cage
'02 Grn L   12 Grn +     20 Red Zed
'04 Blu L   14 Blu +     22 Dith #1
'06 Mag L   16 Red -     24 Dith #2
'08 Red 1   18 Grn -     26 Indestr
'0A Grn 1   1A Blu -     3F BG
'0C Blu 2   1C Red Cage
'Space Invader:
[3F3F0A3F3F3F3F0A3F3F]
[3F3F3F0A3F3F0A3F3F3F]
[3F3F3F0A3F3F0A3F3F3F]
[3F3F1010101010103F3F]
[3F100C0C0C0C0C0C103F]
[3F100C000C0C000C103F]
[10100C000C0C000C1010]
[10100C0C0C0C0C0C1010]
[10101010101010101010]
[103F1010101010103F10]
[103F103F3F3F3F103F10]
[3F3F3F123F3F123F3F3F80]
:LEV48
[0C262626262626262626]
[1C1E3F1C1E1C1E1C1E1C]
[2626062626262626260C]
[3F3F3F3F3F3F3F3F3F3F]
[0C26262626262626261C]
[3F3F3F3F3F3F3F3F3F3F]
[26062626262626262626]
[3F3F3F3F3F3F3F3F3F3F]
[260C262626262626261E]
[3F3F3F3F3F3F3F3F3F3F]
[06262626262626262626]
[3F3F3F3F3F3F3F3F3F3F]
[22222222222222222222]
[100C22100C22100C221080]


'5 DOWN		 '
:TITLE_SCREEN
[" PRESS FIRE TO PLAY "]	'18*16
["                    "]
[" P PLAYER CONTROL   "]
["                    "]
[" G GAME SCHEME      "]
["                    "]
[" M TOGGLE AUDIO     "]
:HALFWAY_POINT
["                    "]
[" D DIFFICULTY       "]
["                    "]
[" I INSTRUCTIONS     "]
["                    "]
[" H HIGH SCORES      "]
["                    "]
["     WRITTEN BY     "]
["   TWILIGHTE 2002!"]
:HSENTRY_SCRN
["   NEW HIGH SCORE   "]
["                    "]
[" PLEASE ENTER  NAME "]
["                    "]
["ABCDEFGHIJKLMNOPQRST"]
["UVWXYZ0123456789<=> "]
["                    "]
["       <<<<         "]
["                    "]
["LEFT<RIGHT TO SELECT"]
[" FIRE FOR NEXT CHAR "]
["   DEL TO GO BACK   "]
["     ESC TO END!"]


:INSTRUCTIONS
["     %PULSOIDS.!"]
["   %INSTRUCTIONS.!"]
["!!"]
[" AS LIFEFORMS IN THE"]
["GALAXY  EVOLVED   SO"]
["THEIR  TECHNOLOGICAL"]
["STEPS INCREASED<!"]
["GRADUALLY   THEY!"]
["LEARNED  TO   TRAVEL"]
["BETWEEN  PLANETS AND"]
["EVENTUALLY   THE!"]
["ENTIRE GALAXY BECAME"]
["A UNIFIED TERRITORY<"]
["!"]
["    SEVERAL THOUSAND"]
["YEARS  AGO WHEN MOST"]
:INST02
["LIFEFORMS   IN   THE"]
["GALAXY  HAD ATTAINED"]
["GRADE  THIRTY  CIVIL"]
["ISATION STATUS<<<!"]
["!"
["THE LASER BASED GAME"]
["THAT  IS  NOW CALLED"]
["PULSOIDS  FIRST CAME"]
["INTO BEING<       IT"]
["QUICKLY  BECAME  THE"]
["ULTIMATE   SPORTING "]
["CHALLENGE<!!!!!"]
:INST03
["$THE ART OF PULSOID."]
["!"]
["      USE THE ENERGY"]
["MIRROR   a----    TO"]
["DEFLECT PULSOIDS d!"]
["BACK  INTO  THE BODY"]
["OF  THE ARENA AND TO"]
["COLLECT   FALLING!"]
["BONUS BATTERIES 3 8 "]
["RELEASED    AFTER!"]
["MIRROR BLOCKS j- v- "]
["ARE DESTROYED<!"]
:INST14
["!!"]
[" :-   *ALIENS+    ; "]
["!"]
["ALIENS ALSO EXIST IN"]
["THE  ARENA AND ENTER"]
["THROUGH  THE  EYE AT"]
["THE TOP<!"]
["!"]
["   IF AN ALIEN MOVES"]
["OVER  A  PULSOID  IT"]
["WILL  BE   DESTROYED"]
["BUT  THE    PULSOIDS"]
["WILL SPLIT INTO TWO<"]
:INST04
["!!!"]
["    ENERGY MIRROR!"]
["!"]
["DEFLECTING A PULSOID"]
["OFF A MIRRORS CENTRE"]
["WILL MAKE IT CONTINU"]
["UP  IN  ITS  CURRENT"]
["PATH.!"]
["DEFLECTING A PULSOID"]
["OFF A  MIRRORS SIDES"]
["WILL REDIRECT IT IN "]
["THAT DIRECTION<!"]
:INST05
["THE PULSOID MAY ALSO"]
["BE CAPTURED AND  SET"]
["AGAIN ON A DIFFERENT"]
["COURSE BY AIMING THE"]
["ENERGY MIRROR SIDEON"]
["INTO THE PULSOIDS!"]
["PATH<!"]
["!!!!!"]
[" %BONUS BATTERIES.!"]
["!"]
["3 WARPS THE ENERGY!"]
:INST06
["  MIRROR INCREASING "]
["  ITS WIDTH<!"]
["!"]
["6 DISTORTS THE!"]
["  PERCEPTION OF TIME"]
["  SLOWING GAMEPLAY< "]
["!"]
["5 ALLOWS THE  ENERGY"]
["  MIRROR  TO  ABSORB"]
["  MOST OF A PULSOIDS"]
["  ENERGY  DEPOSITING"]
["  IN  BONUS   SCORE<"]
["!"]
["7 INCREASES    STOCK"]
["  OF  PLAYERS ENERGY"]
:INST07
["  MIRRORS<!"]
["!"]
["8 ACTIVATES A PLASMA"]
["  BARRIER    ACCROSS"]
["  THE  BACK  WALL OF"]
["  THE  ARENA   WHICH"]
["  WILL   DEFLECT!"]
["  PULSOIDS WHEN FIRE"]
["  IS  PRESSED  UNTIL"]
["  PLASMA EXHAUSTED< "]
["!"]
["9 TEMPORARILY!"]
["  DEACTIVATES THE!"]
["  REFLECTIVE POWERS "]
:INST08
["  OF MIRROR BLOCKS!"]
["  ALLOWING PULSOIDS "]
["  TO PASS STRAIGHT!"]
["  THROUGH THEM<!"]
["!"]
["4 DISTORTS THE!"]
["  PERCEPTION OF TIME"]
["  SPEEDING UP THE!"]
["  ENERGY MIRROR<!"]
["!!!!!"]
["  &MIRROR BLOCKS.!"]
["!"]
["ALL EFFECTS THAT THE"]
:INST09
["MIRROR BLOCKS IMPOSE"]
["ARE  TEMPORARY   AND"]
["MAY ALSO BE DISABLED"]
["BY COLLECTING  BONUS"]
["BATTERY<!"]
["!!"]
["q- ABSORBS PULSOIDS "]
["   ENERGY<!"]
["   s- RELEASES 3!"]
["!"]
["n- RELEASES ENERGY!"]
["   TO PULSOIDS<!"]
["   p- RELEASES 5!"]
["!"]
["j- ONE HIT REQUIRED "]
:INST10
["   TO DESTROY<!"]
["!"]
["l- TWO HITS REQUIRED"]
["   TO DESTROY<!"]
["   l- RELEASES 5!"]
["!"]
["f- SPEEDS UP PLAYERS"]
["   PERCEPTION OF!"]
["   PULSOIDS SPEED<!"]
["   f- RELEASES 7!"]
["   g- RELEASES 7!"]
["   h- RELEASES 6!"]
["!"]
["y- INDESTRUCTABLE!"]
["!"]
["v- RELEASES 9!"]
["!"]
["t- REVERSES PLAYERS "]
["   ENERGY MIRROR<!"]
["   t- RELEASES 8!"]
:INST11
["!"]
["u- REMOVES ENERGY!"]
["   MIRRORS MOVEMENT "]
["   DAMPENERS<!"]
["   u- RELEASES 4!"]
["!"]
["w- DEFLECTS PULSOIDS"]
["   BACK THE WAY THEY"]
["   CAME<!"]
["   TWO HITS REQUIRED"]
["   TO DESTROY<!"]
["   w- RELEASES 8!"]
["!!!!!"]
["    (DURING GAME.!"]
["!"]
["ESCAPE     QUIT MENU"]
["DELETE    PAUSE MENU"]
["!!!!!"]
:INST12
["     )CREDITS.!"]
["!"]
[" &PROGRAM AND MUSIC."]
["  JONATHAN BRISTOW!"]
["!"]
[" &ADDITIONAL CODE.!"]
["    SIMON GUYART!"]
["   JEROME DEBRUNE!"]
["!"]
["   &PLAY TESTERS.!"]
["    ROMUALD LINE!"]
:INST13
["   JEROME DEBRUNE!"]
["  MICKAEL POINTIER!"]
["    JAMES GROOM!"]
["!"]
[" &ADDITIONAL IDEAS. "]
["    ROMUALD LINE!"]
["   MICKAEL POINTIER "]
["   JEROME DEBRUNE!"]
["!"]
["    &INSPIRATION.!"]
["   FABRICE FRANCES!"]
["    SIMON GUYART!"]
:INST11
["   SIMON ULLYATT!"]
["!"]
["&FRENCH TRANSLATION."]
["   ROMUALD LINE!"]
["  JEROME DEBRUNE!"]
["!!!!!!!!!!!!!!!!!!!!!!!@"]

:INST_COLOURBLOCKS
[040606060407] '$
[010503050107] '%
[020307030207] '&
[060606030707] ''
[070707070707] '(
[060307070707] ')
[0C0C0C0C0C07] '*
[080808080807] '+

:KEY_TEXT
["LEFT SHIFT  Z  X"]
["                "]
["CTRL AND CURSORS"]
["SPCE AND CURSORS"]
:JOY_OPTIONS
["TELESTRAT JOYSTK"]
[" NOT AVAILABLE  "]
:COMBO_TEXT
["ONE PLAYER GAME "]
["TWO PLAYER GAME "]
:SOUND_TEXT
["DISABLED  "]
["ACTIVE    "]
:DIFFICULTY_TEXT
["EASY    "]
["NORMAL  "]
["RAPID   "]
["XXXX    "]

:HOF_TEXT
["   HALL OF FAME   "]
:HOS_TEXT
["  HALL  OF SHAME  "]
:HS_INPUT
[#20*$04]
:DF_BAT_SPEED
[20181810]
:DF_BAT_DELAY
[40403020]
:DF_PUL_DELAY
[C0806040]
:DF_PUL_LIGHT
[80403020]
:DF_PUL_SLOWD
[E0C0A060]

:TITLE_MESSAGE
["CEO2002         PROGRAM AND SIDSOUND=TWILIGHTE               "]
["PLAYTESTERS=JEDE<ROMU<DBUG<LOTHLIN     ORIGINAL MUSIC=TSCHOGL"]
["     ORIGINAL GAME=C64 PULSOID MASTERTRONIC 1987        GREET"]
["S TO DBUG<JEDE<ROMU<RAUL<MUSO<CHAOS<EUPHO<LOTHLIN<STATO      !"]


:LEVEL_MESSAGE
["     DIFFICULTY=        SCREEN=      !"]
:PAUSED_MESSAGE
["GAME PAUSED       PRESS FIRE TO RESUME      !"]
:ESCAPE_MESSAGE
["PRESS ESCAPE AGAIN TO QUIT OR FIRE TO LOSE A LIFE            !"]
:HS_MESSAGE
["WELL DONE<<< PLAYER X HAS ACCRUED A NEW HIGH SCORE               !"]
:CHEAT_MESSAGE
["OI TIGER PANTS<<<   IS THE GAME TOO HARD FOR YOU>          !"]
:HOF_MESSAGE
["GOOD ON YA...  IF YOUR NAME IS HERE THEN YOUR A REAL ORICIAN NOW>        !"]
:HOS_MESSAGE
["SHAME ON YOU...  IF YOUR NAME IS HERE THEN YOUR A SPECTRUM OWNER>        !"]
:INST_MESSAGE
["PRESS P TO TOGGLE SPEED<<<   HOLD P TO PAUSE SCROLL<<<   "]
["PRESS FIRE TO QUIT<<<    !"]
:FAME_MESSAGE
[" HALL OF FAME!"]
:SHAME_MESSAGE
["HALL OF SHAME!"]
:DISCSAVE_ERROR
["PROBLEM SAVING HIGH SCORE< CHECK DISC!"]
:DISCSAVE_MESSAGE
["     HIGH SCORE SAVED TO DISC>>      !"]
:DISCLOAD_ERROR
["PROBLEM LOADING HIGH SCORE<CHECK DISK!"]
:DISCLOAD_MESSAGE
["    HIGH SCORE LOADED FROM DISC>>    !"]
:DISC_LOADING
["LOADING HIGH SCORE TABLES...         !"]
:DISC_SAVING
["SAVING HIGH SCORE TABLES...          !"]


:EXTENSION_TEXT
["STNDRDTH"]

:MESSAGE_VECTORLO
[L:TITLE_MESSAGE,:LEVEL_MESSAGE,:PAUSED_MESSAGE,:ESCAPE_MESSAGE]
:MVNT_01
[L:HS_MESSAGE,:HOF_MESSAGE,:HOS_MESSAGE,:INST_MESSAGE,:INSTRUCTIONS]
:MVNT_02
[L:FAME_MESSAGE,:SHAME_MESSAGE,:CHEAT_MESSAGE]
:MVNT_06
[L:DISCSAVE_ERROR,:DISCSAVE_MESSAGE,:DISCLOAD_ERROR,:DISCLOAD_MESSAGE]
:MVNT_07
[L:DISC_LOADING,:DISC_SAVING]
:MESSAGE_VECTORHI
[H:TITLE_MESSAGE,:LEVEL_MESSAGE,:PAUSED_MESSAGE,:ESCAPE_MESSAGE]
:MVNT_03
[H:HS_MESSAGE,:HOF_MESSAGE,:HOS_MESSAGE,:INST_MESSAGE,:INSTRUCTIONS]
:MVNT_04
[H:FAME_MESSAGE,:SHAME_MESSAGE,:CHEAT_MESSAGE]
:MVNT_05
[H:DISCSAVE_ERROR,:DISCSAVE_MESSAGE,:DISCLOAD_ERROR,:DISCLOAD_MESSAGE]
:MVNT_08
[H:DISC_LOADING,:DISC_SAVING]

:CHAR_ADDRLO
[AEAFB0B1B2B3B4B5B6B7]	'48-57 0-9
[0001D4D5D69494]		'58-64 PUNC
'[9494D4D5D69494]		'58-64 PUNC
[D4D5D6D7]		'65-68 A-D
[EF44454647]		'69-73 E-I
[00010203040506070809]        '74-82 J-R
[0A0B0C0D0E0FD7]              '83-89 S-Z
[D7D7D70001]
:CHAR_ADDRHI
[99999999999999999999]
[92929C9C9C9999]
'[99999C9C9C9999]
[98989898]
[989B9B9B9B]
[9C9C9C9C9C9C9C9C9C9C]
[9C9C9C9C9C9C9C]
[9898989292]
:COLOUR_FADE
[040105020603070306020501]

:TYLOCL
[0AFAEADACABAAA9A8A7A6A5A4A3A2A1A]
:TYLOCH
[A7A7A8A9AAABACADAEAFB0B1B2B3B4B5]

:MSG_PLAYER
["PLAYER"]	'PLAYER 1
:MSG_SCREEN
["SCREEN"]	'SCREEN 01
:MSG_GAMEOVER
["GAME OVER"]
:MSG_PAUSED
["GAME PAUSED - PRESS FIRE TO RESUME"]
:MSG_PRESSFIRE
["PRESS FIRE TO PLAY"]

:LIVES_SLOCHI
[A5AF]
:SCORE_SLOCLO
[DEDE]
:SCORE_SLOCHI
[A8B2]
:BONUS_SLOCLO
[FED6]
:BONUS_SLOCHI
[ABB5]
:EOL_FLAG
[0000]

'ALIEN TABLES
:ALIEN_GBASELO
[C8E8F4B0BC]
:ALIEN_GBASEHI
[989B9B9C9C]
:ALIEN_ACTION
[80808080]
'80 INACTIVE
'00 ALIEN INTRO
'01 FADE IN #4 (DARK)
'02 FADE IN #3
'03 FADE IN #2
'04 FADE IN #1
'05 FADE IN #0 (BRIGHT)
'06 MOVING UP IN EYE
'07 MOVING DOWN IN EYE
'08 ON SCREEN (OS) STILL (DECIDE WHICH AVAILABLE DIRECTION: L/R/U/D)
'09 OS: MOVING DOWN (PRIORITY IS TO HEAD TOWARDS BAT)
'0A OS: MOVING LEFT
'0B OS: MOVING UP
'0C OS: MOVING RIGHT
'0D FADE OUT #0 (BRIGHT)
'0E FADE OUT #1
'0F FADE OUT #2
'10 FADE OUT #3
'11 FADE OUT #4
'12 FADE OUT #5 (GONE!)
'13 DISABLE ALIEN

:ALIEN_X
[00000000]
:ALIEN_Y
[00000000]
:ALIEN_GFXLO
[00000000]
:ALIEN_GFXHI
[00000000]
:RND_DELAY
[12121212]
:AA_VECTORLO
[L&ALIEN_START,&FADE_IN_4,&FADE_IN_3,&FADE_IN_2,&FADE_IN_1,&FADE_IN_0]
[L&MOVING_UP_INEYE,&MOVING_DOWN_INEYE,&ON_SCREEN,&OS_MDOWN,&OS_MLEFT]
[L&OS_MUP,&OS_MRIGHT,&FADE_OUT_0,&FADE_OUT_1,&FADE_OUT_2,&FADE_OUT_3]
[L&FADE_OUT_4,&FADE_OUT_5,&DISABLE_ALIEN]
:AA_VECTORHI
[H&ALIEN_START,&FADE_IN_4,&FADE_IN_3,&FADE_IN_2,&FADE_IN_1,&FADE_IN_0]
[H&MOVING_UP_INEYE,&MOVING_DOWN_INEYE,&ON_SCREEN,&OS_MDOWN,&OS_MLEFT]
[H&OS_MUP,&OS_MRIGHT,&FADE_OUT_0,&FADE_OUT_1,&FADE_OUT_2,&FADE_OUT_3]
[H&FADE_OUT_4,&FADE_OUT_5,&DISABLE_ALIEN]
:AYLOCL
[0B335B83ABD3FB234B739BC3EB133B638BB3DB03]
:AYLOCH
[A0A0A0A0A0A0A0A1A1A1A1A1A1A2A2A2A2A2A2A3]
:SOF2
[0001282950517879A0A1]


'PULSE TABLES
:STREAM_X
[#00*$256]
:STREAM_Y
[#00*$256]
:PULSE_TAIL	'DELETION
[#00*$8]
:PULSE_HEAD	'PLOT
[#00*$8]
:PULSE_SPEED	'NORMAL LIGHTNING SLOWDOWN
[8040C0]
:ACTIVITY		'80=OFF 0=UR 1=DR 2=DL 3=UL  (DIRECTION)
[#80*$8]
:ACTION_LO
[L&MOVE_UR,&MOVE_DR,&MOVE_DL,&MOVE_UL]
:ACTION_HI
[H&MOVE_UR,&MOVE_DR,&MOVE_DL,&MOVE_UL]
:LENGTHEN_DELAY
[#00*$8]
:SHORTEN_DELAY
[#00*$8]
:PULSE_OFF
[#00*$8]

'TILE ACTIVITY TABLES
:TILE_SLOCL
[#00*$16]
:TILE_SLOCH
[#00*$16]
:TILE_ACT	'80=INACTIVE 00=FLASH TILE 01=FADE TILE
[#80*$16]
:TILE_FRAME 'ALWAYS STARTS AT E8
[#00*$16]
:TILE_VECTOR_LO
[L&TV_LRED,&TV_LGRN,&TV_LBLU,&TV_LMAG,&TV_ORED,&TV_OGRN,&TV_OBLU1]
[L&TV_OBLU2,&TV_PRED,&TV_PGRN,&TV_PBLU,&TV_MRED,&TV_MGRN,&TV_MBLU]
[L&TV_RCAGE,&TV_BCAGE,&TV_RZED,&TV_DITH1,&TV_DITH2,&TV_INDES]
:TILE_VECTOR_HI
[H&TV_LRED,&TV_LGRN,&TV_LBLU,&TV_LMAG,&TV_ORED,&TV_OGRN,&TV_OBLU1]
[H&TV_OBLU2,&TV_PRED,&TV_PGRN,&TV_PBLU,&TV_MRED,&TV_MGRN,&TV_MBLU]
[H&TV_RCAGE,&TV_BCAGE,&TV_RZED,&TV_DITH1,&TV_DITH2,&TV_INDES]
'BONUS TABLES
:BONUS_FRAME '0-15 (B7 SET FOR INACTIVE) THE FRAME INDEX (0=BONUS_IMAGE)
[#80*$08]
:BONUS_IMAGE        'THE ACTUAL BONUS IMAGE
[#00*$08]
:BONUS_X            'BONUS X POSITION (IN BYTE STEPS)
[#00*$08]
:BONUS_Y            'BONUS Y POSITION (IN PIXEL STEPS)
[#00*$08]
'E0 L     LONG BAT
'E1 S     SPEED-UP
'E2 C     EAT BAT
'E3 D     SLOW PULSE
'E4 X     EXTRA LIFE
'E5 =     BARRIER
'E6 N (n) INVINCIBLE
:BONUS_TYPE	'20 ENTRIES: BONUS ADRLO FOR EACH TYPE OF TILE OR ZERO(NONE)
[E4E4E300000000E2]  'NEED TO SORT THESE OUT?
[0000E20000E000E1]
[E600E500]
:BONUS_REF	'IDX BY FRAME        THE FRAME POINTERS (22 FRAMES)
[00000000E8E9EAEBECEDEE00000000EEEDECEBEAE9E8]
:BONUS_MOVE
[01000000000100010001000100000000010001000100]

:BONUS_VECTORL
[L&BTYPE_E0,&BTYPE_E1,&BTYPE_E2,&BTYPE_E3]	'BONUS VECTORS WHEN CAPTURED
[L&BTYPE_E4,&BTYPE_E5,&BTYPE_E6,&BTYPE_E7]
:BONUS_VECTORH
[H&BTYPE_E0,&BTYPE_E1,&BTYPE_E2,&BTYPE_E3]
[H&BTYPE_E4,&BTYPE_E5,&BTYPE_E6,&BTYPE_E7]
'NORMAL   WIDE   EAT
:BAT_EXTREMITY
<$97,$89,$97>
:BAT_BYTES	'#$24
<$24,$29,$24>
:BAT_LO
[902058]
:BAT_HI
[999B9A]
:BAT_WIDTH
<$23,$29,$23>
:BAT_RFLANK
<$18,$24,$18>
:BAT_WBYTES
[050705]


:SYLOCL
[6991B9E109315981A9D1F921497199C1]
[E911396189B1D901295179A1C9F11941]
[6991B9E109315981A9D1F921497199C1]
[E911396189B1D901295179A1C9F11941]
[6991B9E109315981A9D1F921497199C1]
[E911396189B1D901295179A1C9F11941]
[6991B9E109315981A9D1F921497199C1]
[E911396189B1D901295179A1C9F11941]
[6991B9E109315981A9D1F921497199C1]
[E911396189B1D901295179A1C9F11941]
:ACTIVATE_TEXT
[C0ABB9B9]
:SYLOCH
[A1A1A1A1A2A2A2A2A2A2A2A3A3A3A3A3]
[A3A4A4A4A4A4A4A5A5A5A5A5A5A5A6A6]
[A6A6A6A6A7A7A7A7A7A7A7A8A8A8A8A8]
[A8A9A9A9A9A9A9AAAAAAAAAAAAAAABAB]
[ABABABABACACACACACACACADADADADAD]
[ADAEAEAEAEAEAEAFAFAFAFAFAFAFB0B0]
[B0B0B0B0B1B1B1B1B1B1B1B2B2B2B2B2]
[B2B3B3B3B3B3B3B4B4B4B4B4B4B4B5B5]
[B5B5B5B5B6B6B6B6B6B6B6B7B7B7B7B7]
[B7B8B8B8B8B8B8B9B9B9B9B9B9B9BABA]
:MR_YLOCL
[7878787878788E8E8E8E8E8E]
[A4A4A4A4A4A4BABABABABABA]
[D0D0D0D0D0D0E6E6E6E6E6E6]
[FCFCFCFCFCFC121212121212]
[2828282828283E3E3E3E3E3E]
[5454545454546A6A6A6A6A6A]
[808080808080969696969696]
[ACACACACACACC2C2C2C2C2C2]
[D8D8D8D8D8D8EEEEEEEEEEEE]
[0404040404041A1A1A1A1A1A]
[303030303030464646464646]
[5C5C5C5C5C5C727272727272]
[8888888888889E9E9E9E9E9E]
:MR_YLOCH
[9D9D9D9D9D9D9D9D9D9D]
[9D9D9D9D9D9D9D9D9D9D9D9D]
[9D9D9D9D9D9D9D9D9D9D9D9D]
[9D9D9D9D9D9D9D9D9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E9E9E]
[9E9E9F9F9F9F9F9F9F9F9F9F]
[9F9F9F9F9F9F9F9F9F9F9F9F]
[9F9F9F9F9F9F9F9F9F9F9F9F]
[9F9F9F9F9F9F9F9F9F9F9F9F9F9F]
:BITPOS
[201008040201201008040201201008040201201008040201201008040201201008040201]
[201008040201201008040201201008040201201008040201201008040201201008040201]
[201008040201201008040201201008040201201008040201201008040201201008040201]
[201008040201201008040201201008040201201008040201201008040201201008040201]
:BITMSK
[DFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFE]
[DFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFE]
[DFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFE]
[DFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFEDFEFF7FBFDFE]


'MAP PLOT TABLES
:LEVEL_ADDRESS_LO
[L:TITLE_SCREEN,:LEV01,:LEV02,:LEV03,:LEV04,:LEV05,:LEV06,:LEV07,:LEV08]
:TEMP_ZX1
[L:LEV09,:LEV10,:LEV11,:LEV12,:LEV13,:LEV14,:LEV15,:LEV16,:LEV17,:LEV18]
:TEMP_ZX3
[L:LEV19,:LEV20,:LEV21,:LEV22,:LEV23,:LEV24,:LEV25,:LEV26,:LEV27,:LEV28]
:TEMP_ZX5
[L:LEV29,:LEV30,:LEV31,:LEV32,:LEV33,:LEV34,:LEV35,:LEV36,:LEV37,:LEV38]
:TEMP_ZX7
[L:LEV39,:LEV40,:LEV41,:LEV42,:LEV43,:LEV44,:LEV45,:LEV46,:LEV47,:LEV48]
:TEMP_ZX9
[L:HSENTRY_SCRN]
:LEVEL_ADDRESS_HI
[H:TITLE_SCREEN,:LEV01,:LEV02,:LEV03,:LEV04,:LEV05,:LEV06,:LEV07,:LEV08]
:TEMP_ZX2
[H:LEV09,:LEV10,:LEV11,:LEV12,:LEV13,:LEV14,:LEV15,:LEV16,:LEV17,:LEV18]
:TEMP_ZX4
[H:LEV19,:LEV20,:LEV21,:LEV22,:LEV23,:LEV24,:LEV25,:LEV26,:LEV27,:LEV28]
:TEMP_ZX6
[H:LEV29,:LEV30,:LEV31,:LEV32,:LEV33,:LEV34,:LEV35,:LEV36,:LEV37,:LEV38]
:TEMP_ZX8
[H:LEV39,:LEV40,:LEV41,:LEV42,:LEV43,:LEV44,:LEV45,:LEV46,:LEV47,:LEV48]
:TEMP_ZXA
[H:HSENTRY_SCRN]
:MREF_RESERVEL
[C488]
:MREF_RESERVEH
[9593]
:MREF_ADDRESS_LO
[BBBDBFC1C3C5C7C9CBCD]
[D1D3D5D7D9DBDDDFE1E3]
[E7E9EBEDEFF1F3F5F7F9]
[FDFF01030507090B0D0F]
[131517191B1D1F212325]
[292B2D2F31333537393B]
[3F41434547494B4D4F51]
[5557595B5D5F61636567]
[6B6D6F71737577797B7D]
[81838587898B8D8F9193]
[97999B9D9FA1A3A5A7A9]
[ADAFB1B3B5B7B9BBBDBF]
[C3C5C7C9CBCDCFD1D3D5]
[D9DBDDDFE1E3E5E7E9EB]
:MREF_ADDRESS_HI
[9D9D9D9D9D9D9D9D9D9D]
[9D9D9D9D9D9D9D9D9D9D]
[9D9D9D9D9D9D9D9D9D9D]
[9D9D9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
[9E9E9E9E9E9E9E9E9E9E]
:MSCN_ADDRESS_LO
[3A3C3E40424446484A4C]
[2A2C2E30323436383A3C]
[1A1C1E20222426282A2C]
[0A0C0E10121416181A1C]
[FAFCFE00020406080A0C]
[EAECEEF0F2F4F6F8FAFC]
[DADCDEE0E2E4E6E8EAEC]
[CACCCED0D2D4D6D8DADC]
[BABCBEC0C2C4C6C8CACC]
[AAACAEB0B2B4B6B8BABC]
[9A9C9EA0A2A4A6A8AAAC]
[8A8C8E90929496989A9C]
[7A7C7E80828486888A8C]
[6A6C6E70727476787A7C]
:MSCN_ADDRESS_HI
[A4A4A4A4A4A4A4A4A4A4]
[A5A5A5A5A5A5A5A5A5A5]
[A6A6A6A6A6A6A6A6A6A6]
[A7A7A7A7A7A7A7A7A7A7]
[A7A7A7A8A8A8A8A8A8A8]
[A8A8A8A8A8A8A8A8A8A8]
[A9A9A9A9A9A9A9A9A9A9]
[AAAAAAAAAAAAAAAAAAAA]
[ABABABABABABABABABAB]
[ACACACACACACACACACAC]
[ADADADADADADADADADAD]
[AEAEAEAEAEAEAEAEAEAE]
[AFAFAFAFAFAFAFAFAFAF]
[B0B0B0B0B0B0B0B0B0B0]
:SOFS
[00285078A0]	'FOR CLEARING LEFT-SIDE OF BAT (1 COLUMN)
[01295179A1]	'EXTENDED FOR BLOCKS           (2 COLUMNS)
[022A527AA2]				'(3 COLUMNS)
[032B537BA3]				'(4 COLUMNS)
[042C547CA4]	'EXTENDED FOR BAT-SMALL        (5 COLUMNS)
[052D557DA5]	'EXTENDED FOR BAT-LARGE        (6 COLUMNS)
:BP_FRAME
[000102030405000102030405000102030405000102030405]
[000102030405000102030405000102030405000102030405]
[000102030405000102030405000102030405000102030405]
[000102030405000102030405000102030405000102030405]
[000102030405000102030405000102030405000102030405]
[000102030405000102030405000102030405000102030405]
:XLOC
[000000000000010101010101020202020202030303030303]
[040404040404050505050505060606060606070707070707]
[0808080808080909090909090A0A0A0A0A0A0B0B0B0B0B0B]
[0C0C0C0C0C0C0D0D0D0D0D0D0E0E0E0E0E0E0F0F0F0F0F0F]
[101010101010111111111111121212121212131313131313]
[141414141414151515151515161616161616171717171717]
'KEYBOARD TABLES
'  P1    PAUSE SUICIDE
'Z X LSH   P    ESC
'B0-7
:KEY_ROW
[0200040501]
:KEY_COL
[DFBFEFDFDF]


'Z X LS < > LCJOYSTK< >SP
:CHOICE_ROW
[020004808080040402040404]
'[020004040402808080040404]
:CHOICE_COL
[DFBFEF000000DF7FEFDF7FFE]
'[DFBFEFDF7FEF000000DF7FFE]
:KEY_BIT
[0102040810204080]
:PC_KROW	'PGMD(FIRE)IH
[05060201020506]
:PC_KCOL
[F7FBFE7FEFFDFD]
:JOYSTICK_MASK
[BF7F]
:PC_VECTORL	'PGMD(FIRE)IH
[L&PC_PLAYER,&PC_COMBO,&PC_VOLUME,&PC_DIFF]
[L&PC_START,&PC_INSTRUCTIONS,&PC_HISCORE,&SFX_IRQ,&MUSIC_IRQ]
:PC_VECTORH
[H&PC_PLAYER,&PC_COMBO,&PC_VOLUME,&PC_DIFF]
[H&PC_START,&PC_INSTRUCTIONS,&PC_HISCORE,&SFX_IRQ,&MUSIC_IRQ]
:PC_FIREC
[EFFFEFFE]
:PC_FIRER
[04000204]
:JOY_CODE
[000000000000000000]
[040606000002020005]
[040500010001000506]
[0400010200]
:BONUS2ADD
[0000]
:SCORE2ADD
[0000]
'SFX TABLES
:AY_REGISTER
[00010203060708090E]
:BASE_NOTE_LO
[770BA647EC9747FBB37030F4]
:BASE_NOTE_HI
[070706060505050404040403]

;KEY_DELAY	($10)
;OLD_KEY

;BAT_X		($49)
'BAT WIDTH IS EITHER 17 OR 23 PIXELS WIDE
'THRESHOLDS ARE BLEFT(3/3) BCENTRE(11/17) BRIGHT(3/3)
;BAT_DELAY          ($01)
;BAT_DREF		($64)
;BAT_VELO		($32)
;BAT_NORMALSPEED	($64)
;INVINCE_FLAG	($00)
;PULSE_DELAY 	($01)
;PULSE_DREF         ($192)
;BONUS_DELAY	($01)
;BONUS_OVERBAT	($00)
;BAT_MOVED	($01)
;BAT_TYPE           ($00)
;SLOW_DELAY	($00)
;BARRIER_FLAG	($00)
;BARRIER_INVERSE	($00)
;BARRIER_UP	($00)
;LIGHTNING_FLAG	($00)
;ALIEN_DELAY	($03)
;BRINGEMON_DELAY	($255)
;TILE_COUNT	($00)
;RND_SEED		($83)
;PC_PLAY_CTRL       ($02)
;PC_PLAYCOMBO	($00)
;PC_DIFFICULTY      ($01)
;CHEAT_CHECK	($255)
;ORIGINAL_DIFFICULTY ($00)
;AUDIO_FLAG	($01)
;SCROLL_FLAG        ($00)
;WIDE_COUNT	($00)
;SCROLL_CNT	($00)
;SCROLL_REF	($10)
;COLOUR_CYCLE	($01)
;CYCLIC_DELAY	($00)
;START_LEVEL	($01)
;OPERATING_SYSTEM   ($16)	'00=TELESTRAT 16=ORIC1/ATMOS
;COL_FADE		($00)
;CF_COUNT           ($00)
;REVERSE_FLAG	($00)
;LAST_MOVE	($00)	'00=LEFT 01=RIGHT
;ICE_FLAG		($00)
;BAT_ICED		($00)
;XTRA_SLOW          ($00)
;HSNAME_POSITION    ($00)
;HS_CURRENT_CHAR    ($00)
;HS_COLOUR	($00)
;HS_ENTRY		($00)
;SCROLL_DELAY	($02)
;SD_REF		($01)
;SS_EVENLINE	($00)
;REPEAT_FLAG	($00)
;HS_DELAY           ($20)
;HS_RPTCNT          ($01)
;HS_KEYDELAY        ($127)

'B0-BF CHIP SFX VARIANTS
'C0-DF GAME VARIANTS
'E0-FF GAME CODE TEMP

'1000 MUSIC
'1F00 HISCORE TABLE (6 CHARS+3 SCORE+1 DIFF*20)
'1FC8 SPARE
'2000 MC&TABLES&TEXT
'760F SPARE
'
'9000 ORNAMENT SFX
'9100 SAMPLE SFX
'9140 SPARE
'9180 SFX PARAMS
'9200 SPARE
'9388 MREF REF
'95C4 MREF ORIG
'9800 PULBLOCKS
'???? EYESTUFF
'A000 HIRES


&GAME_DRIVER
	JSR &DETECT_SYSTEM
	LDA #00
	STA BF50
	STA BF51
	STA BF52
	JSR &LOAD_HISCORE
&DRV_18	SEI
'	JSR &SWAP_ZP
	JSR &INIT_6522
	LDX #$119	'CLEAR BOTTOM 3 TEXT LINES
	LDA #08
&DRV_07	STA BF68,X
	DEX
	BPL &DRV_07
&DRV_LOOP	JSR &SETUP_MUSIC
	JSR &PLOT_TITLE
	JSR &PLOT_VARIANTS
&DRV_03	JSR &GET_PLAYER_CHOICE
	JSR &WIPE_ARENA
	JSR &DISABLE_ALL_ACTIVITIES
	JSR &SETUP_KEYS
	JSR &SETUP_PLAYERS	'ALSO SETS UP BFXX
	JSR &SETUP_SFXIRQ
	JSR &DISPLAY_LIVES
	LDA #07
	STA BFE0
&DRV_08	LDA CC		';PLAYER_1_LIVES
	BEQ &DRV_09
	LDA #00
	STA CE
	JSR &PPLAYER_FLAG
	LDA CF		';NEWSTART_P1FLAG
	BNE &DRV_10
	JSR &RESTORE_MREF
	JSR &PRESENT_LEVEL
	JSR &DISABLE_ALL_ACTIVITIES
	LDX D4
	JSR &DISPLAY_MREF
	JMP &DRV_11
&DRV_10	JSR &PRESENT_LEVEL
	JSR &SETUP_NEW_LEVEL
	JSR &DISABLE_ALL_ACTIVITIES
	LDA #04
	STA BFE0
&DRV_11	JSR &PLAY_PLAYER	'UNTIL DEATH
	JSR &STORE_MREF
&DRV_09	LDA CD		';PLAYER_2_LIVES
	BEQ &DRV_12
	LDA #01
	STA CE
	JSR &PPLAYER_FLAG
	LDA D0		';NEWSTART_P2FLAG
	BNE &DRV_14
	JSR &RESTORE_MREF
	JSR &PRESENT_LEVEL
	JSR &DISABLE_ALL_ACTIVITIES
	LDX D5
	JSR &DISPLAY_MREF
	JMP &DRV_15
&DRV_14	JSR &PRESENT_LEVEL
	JSR &SETUP_NEW_LEVEL
	JSR &DISABLE_ALL_ACTIVITIES
	LDA #04
	STA BFE0
&DRV_15	JSR &PLAY_PLAYER	'UNTIL DEATH (SHOW GAMEOVER)
	JSR &STORE_MREF
&DRV_12	LDA CD
	BNE &DRV_08
	LDA CC		';PLAYER_1_LIVES
	BNE &DRV_08
	LDA #C0
	STA A5E4
	STA A634
	STA AFE4
	STA B034
	JSR &CLEAR_MESSAGE
	LDX #00
	JSR &CHECK_HIGH_SCORE
	JSR &CLEAR_MESSAGE
	LDX #03
	JSR &CHECK_HIGH_SCORE
	JSR &CLEAR_MESSAGE
	JMP &DRV_LOOP	'GAME OVER FOR BOTH

&LOAD_HISCORE
	JSR &CLEAR_MESSAGE
	LDA #$16
	LDX #$01
	LDY #$193
	JSR &PLOT_MESSAGE
	JSR 1000
	BEQ &OK_LOAD
	BMI &ERROR_LOAD
	CMP #01
	BEQ &OK_LOAD
	JMP &TAPE_USER
&SAVE_HISCORE
	JSR &CLEAR_MESSAGE
	LDA #$17
	LDX #$01
	LDY #$193
	JSR &PLOT_MESSAGE
	JSR 1004
	LDA #$20
	JSR &RUNTIME_DELAY
	JSR 1004
	BEQ &OK_SAVE
	BMI &ERROR_SAVE
&TAPE_USER
	RTS
&ERROR_SAVE
	LDA #$12
	JMP &LHS_02
&OK_SAVE
	LDA #$13
	JMP &LHS_02
&ERROR_LOAD
	LDA #$14
	JMP &LHS_02
&OK_LOAD
	LDA #$15
&LHS_02	LDX #$01
	LDY #$193
	JSR &PLOT_MESSAGE
	LDA #FF
	JSR &RUNTIME_DELAY
	JMP &CLEAR_MESSAGE

'[L:DISCSAVE_ERROR,:DISCSAVE_MESSAGE,:DISCLOAD_ERROR,:DISCLOAD_MESSAGE]
'[L:DISCSAVE_ERROR,:DISCSAVE_MESSAGE,:DISCLOAD_ERROR,:DISCLOAD_MESSAGE]




&PPLAYER_FLAG
	LDX CE
	BNE &PPF_01
	LDA #8C
	STA A5E4
	STA A634
	LDA #C0
	STA AFE4
	STA B034
	RTS
&PPF_01   LDA #C0
	STA A5E4
	STA A634
	LDA #8C
	STA AFE4
	STA B034
	RTS





&SETUP_NEW_LEVEL
&DRV_05	JSR &SETUP_MREF     'CLEAR MREF
	JSR &BLACKEN_ARENA  'CLEAR SCREEN
	LDY CE            'FETCH LEVEL
	LDX D4,Y
	JSR &PLOT_MREF   	'LEVEL>>MREF>>SCRN
	LDA #00             'RESET FRESHMAN
	LDX CE
	STA CF,X
	RTS

&STORE_MREF
	LDX CE
	LDA :MREF_RESERVEL,X
	STA F0
	LDA :MREF_RESERVEH,X
	STA F1
	LDA #78
	STA F2
	LDA #9D
	STA F3
	LDY #00
&SMR_01	LDA (F2),Y
	STA (F0),Y
	LDA #01
	JSR &ADD_F0
	INC F2
	BNE 02
	INC F3
	LDA F3
	CMP #9F
	BCC &SMR_01
	LDA F2
	CMP #B4
	BCC &SMR_01
	RTS

&RESTORE_MREF
	LDX CE
	LDA :MREF_RESERVEL,X
	STA F0
	LDA :MREF_RESERVEH,X
	STA F1
	LDA #78
	STA F2
	LDA #9D
	STA F3
	LDY #00
&SMR_02	LDA (F0),Y
	STA (F2),Y
	LDA #01
	JSR &ADD_F0
	INC F2
	BNE 02
	INC F3
	LDA F3
	CMP #9F
	BCC &SMR_02
	LDA F2
	CMP #B4
	BCC &SMR_02
	RTS


&SETUP_PLAYERS
	LDA ;PC_PLAYCOMBO
	BEQ &SUP_01
	LDA #04
&SUP_01	STA CD
	LDA #04
	STA CC
	LDX #0B
	LDA #00
&SUP_02	STA C0,X
	DEX
	BPL &SUP_02
	STA CE
	LDA #01
	STA CF
	STA D0
	LDA ;START_LEVEL
	STA D4
	STA D5
	RTS

&GET_PLAYER_CHOICE
	LDX ;OPERATING_SYSTEM
	LDY #10
&GPC_02	LDA :JOY_OPTIONS,X
	STA :KEY_TEXT,Y
	INX
	INY
	CPY #20
	BCC &GPC_02
	LDA #01
	STA ;SCROLL_FLAG
	LDA #$100
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	LDX #00
	JSR &SETUP_MSCROLL

&GPC_LOOP	JSR &MANAGE_SCROLLER
'	JSR &DISPLAY_HSCC
	LDA BF
	CMP ;OLD_KEY
	BEQ &GPC_LOOP
	STA ;OLD_KEY
	CMP #00
	BEQ &GPC_LOOP
	TAX
	DEX
	LDA :PC_VECTORL,X
	STA &GPC_03+1
	LDA :PC_VECTORH,X
	STA &GPC_03+2
	CLC
&GPC_03	JMP BF00

&PC_INSTRUCTIONS
	JSR &SSCROLL_DRIVER
	JMP &GPC_LOOP

&PC_HISCORE
	JSR &WIPE_ARENA
	JSR &CLEAR_MESSAGE
	JSR &POPULATE_HOF
	LDA #01
	STA ;SCROLL_FLAG
	LDA #$100
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	LDX #05
	JSR &SETUP_MSCROLL
	JSR &DISPLAY_HISCORES
	BCS &PCHS_01          'ABORT IF NOT FIRE
	JSR &CLEAR_MESSAGE
	JSR &POPULATE_HOS
	LDX #06
	JSR &SETUP_MSCROLL
	JSR &DISPLAY_HISCORES
&PCHS_01	JSR &PLOT_TITLE
	JSR &PLOT_VARIANTS
	JSR &CLEAR_MESSAGE
	LDX #00
	JSR &SETUP_MSCROLL
&PCHS_02	JSR &CLEAR_KBDBUFFER
	JMP &GPC_LOOP

&SETUP_MSCROLL
	LDA :MESSAGE_VECTORLO,X
	STA 76
	LDA :MESSAGE_VECTORHI,X
	STA 77
	LDY #FF
	STY 78
	LDY #00
	STY 72
	STY ;WIDE_COUNT
	RTS

&PLOT_VARIANTS	'PLOT P1/P2 KEYS, PSCHEME, SELECTED VOLUME
	LDX #03
	LDA ;PC_PLAY_CTRL
	JSR &PCP1_02
	LDX ;PC_PLAYCOMBO
	BEQ 02
	LDX #10
	LDY #03
	JSR &PCP1_03
	LDA ;AUDIO_FLAG
	JSR &PV_01
	JMP &PCDF_02


'PLOT VOLUME
&PC_VOLUME

'         LDA ;START_LEVEL
'         ADC #01
'         CMP #$49
'         BCC 02
'         LDA #01
'         STA ;START_LEVEL
'         JSR &TEST_2DH
'         JMP &GPC_LOOP
	LDA ;AUDIO_FLAG
	EOR #01
	STA ;AUDIO_FLAG
	JSR &PV_01
	JMP &GPC_LOOP
&PV_01	BEQ 02
	LDA #0A
	TAX
	LDY #03
&PV_02	LDA :SOUND_TEXT,X
	STX F0
	LDX #$07
	JSR &PLOT_CHAR
	LDX F0
	INX
	INY
	CPY #$13
	BCC &PV_02
	RTS

&PC_PLAYER
	LDA ;PC_PLAY_CTRL
	ADC #01
	AND #03
	STA ;PC_PLAY_CTRL
	TAX
	LDA :PC_FIREC,X
	LDY #04
	STA :PC_KCOL,Y
	LDA :PC_FIRER,X
	STA :PC_KROW,Y
	TXA
	LDX #03
	JSR &PCP1_02
	JMP &GPC_LOOP

&PCP1_02	STX F1
	ASL
	ASL
	ASL
	ASL
	TAX
	LDY #03
&PCP1_01	STX F0
	LDA :KEY_TEXT,X
	LDX F1
	JSR &PLOT_CHAR	'REG-Y=X POSITION  REG-X=Y POSITION  A=CHAR
	LDX F0
	INX
	INY
	CPY #$19
	BCC &PCP1_01
	RTS


&PC_COMBO LDA ;PC_PLAYCOMBO
	EOR #01
	STA ;PC_PLAYCOMBO
	BEQ 02
	LDA #10
	TAX
	LDY #03
	JSR &PCP1_03
	JMP &GPC_LOOP

&PCP1_03	STX F0
	LDA :COMBO_TEXT,X
	LDX #05
	JSR &PLOT_CHAR
	LDX F0
	INX
	INY
	CPY #13
	BCC &PCP1_03
	RTS

&PC_START	JSR &CLEAR_MESSAGE
	RTS

&CLEAR_MESSAGE
	LDA #29
	STA 70
	LDA #BE
	STA 71
	LDX #05
&CM_02	LDY #24
	LDA #40
&CM_01	STA (70),Y
	DEY
	BPL &CM_01
	JSR &NL_70
	DEX
	BNE &CM_02
	RTS

&NL_70	LDA 70
	CLC
	ADC #$40
	STA 70
	LDA 71
	ADC #$00
	STA 71
	RTS

&UPDATE_DIFF
	LDX ;PC_DIFFICULTY
	LDA :DF_BAT_SPEED,X
	STA ;BAT_VELO
	LDA :DF_BAT_DELAY,X
	STA ;BAT_NORMALSPEED
	STA ;BAT_DELAY
	STA ;BAT_DREF
	LDA :DF_PUL_DELAY,X
	LDY #00
	STA :PULSE_SPEED,Y
	LDA :DF_PUL_LIGHT,X
	INY
	STA :PULSE_SPEED,Y
	LDA :DF_PUL_SLOWD,X
	INY
	STA :PULSE_SPEED,Y
	RTS


&PC_DIFF	LDA ;PC_DIFFICULTY
	ADC #01
	AND #03
	STA ;PC_DIFFICULTY
	STA ;ORIGINAL_DIFFICULTY
	JSR &PCDF_02
	JMP &GPC_LOOP

&PCDF_02	JSR &UPDATE_DIFF
	TXA
	ASL
	ASL
	ASL
	TAX
	LDY #03
&PCDF_01	STX F0
	LDA :DIFFICULTY_TEXT,X
	LDX #09
	JSR &PLOT_CHAR
	LDX F0
	INX
	INY
	CPY #$11
	BCC &PCDF_01
	RTS

'PGMD(FIRE)

&SETUP_KEYS
	LDA ;PC_PLAY_CTRL
	ASL
	ADC ;PC_PLAY_CTRL
	TAX
	LDY #00
&SUK_01	LDA :CHOICE_ROW,X
	STA :KEY_ROW,Y
	LDA :CHOICE_COL,X
	STA :KEY_COL,Y
	INX
	INY
	CPY #03
	BCC &SUK_01
	RTS


&COND_BAT	LDA ;BAT_MOVED
	BEQ &DBAT_01
	LDA #00
	STA ;BAT_MOVED
	JSR &PLOT_BAT
&DBAT_01	RTS


&BAT_MOVE	DEC ;BAT_DELAY
	BNE &DBAT_01
	LDA ;BAT_DREF
	STA ;BAT_DELAY
	LDA #00
	STA ;BAT_ICED
	LDA ;ICE_FLAG
	BEQ &BMOV_13
	LDA ;LAST_MOVE
	BEQ &BMOV_14
	LDA ;BAT_X
	LDX ;BAT_TYPE
	CMP :BAT_EXTREMITY,X	'#$97
	BCS &BMOV_13
	INC ;BAT_X
	INC ;BAT_MOVED
	INC ;BAT_ICED
	JMP &BMOV_13
&BMOV_14	LDX ;BAT_X
	BEQ &BMOV_13
	DEC ;BAT_X
	INC ;BAT_MOVED
	INC ;BAT_ICED
&BMOV_13	LDA BF	'GET KEY
	TAY
	AND #01		'LEFT
	BEQ &BMOV_01
	LDA ;REVERSE_FLAG
	BNE &BMOV_11
&BMOV_12	LDA #00
	STA ;LAST_MOVE
	LDA ;BAT_ICED	'PREVENT DOUBLE MOVE BECAUSE OF ICE
	BNE &BMOV_02
	LDX ;BAT_X
	BEQ &BMOV_02
	DEC ;BAT_X
	INC ;BAT_MOVED
	RTS
&BMOV_01	TYA
	AND #02		'RIGHT
	BEQ &BMOV_02
	LDA ;REVERSE_FLAG
	BNE &BMOV_12
&BMOV_11	LDA #01
	STA ;LAST_MOVE
	LDA ;BAT_ICED	'PREVENT DOUBLE MOVE BECAUSE OF ICE
	BNE &BMOV_02
	LDA ;BAT_X
	LDX ;BAT_TYPE
	CMP :BAT_EXTREMITY,X	'#$97
	BCS &BMOV_02
	INC ;BAT_X
	INC ;BAT_MOVED
&BMOV_03	RTS
&BMOV_02	TYA
	AND #08
	BEQ &BMOV_04
	LDA #01		'PAUSE
	STA ;SCROLL_FLAG
	JSR &BLACK_ARENA
	LDA #$200
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	JSR &CLEAR_MESSAGE
	LDX #02
	JSR &SETUP_MSCROLL
&BMOV_05	JSR &MANAGE_SCROLLER
	LDA BF
	AND #04
	BEQ &BMOV_05
	JSR &CLEAR_MESSAGE
	JSR &CLEAR_KBDBUFFER
	JMP &NLEV_07
&BMOV_04	TYA
	AND #10
	BEQ &BMOV_10
&ECH_01	JSR &CLEAR_KBDBUFFER
	LDA #01
	STA ;SCROLL_FLAG
	LDA #$100
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	JSR &CLEAR_MESSAGE
	LDX #03
	JSR &SETUP_MSCROLL
&ECH_LOOP	JSR &MANAGE_SCROLLER
	LDX CE
	LDA BF
	AND #04
	BNE &ECH_RESTART
	LDA BF
	AND #10
	BEQ &ECH_LOOP
&ECH_QUIT	LDA #01
	STA CC,X
&ECH_RESTART
	LDA #01
	STA :EOL_FLAG,X
	JSR &CLEAR_MESSAGE
	JMP &NLEV_07
&BMOV_10	RTS

&SWAP_ZP  LDX #00
&SWZP_01	LDY 3F00,X
	LDA 00,X
	STY 00,X
	STA 3F00,X
	DEX
	BNE &SWZP_01
	RTS


&PLOT_BAT LDX ;BAT_X
	LDA :XLOC,X
	CLC
	ADC #DA
	STA F0
	LDA #B3
	STA F1
	LDY ;BAT_TYPE
	LDA :BP_FRAME,X
	ASL
	STA F2
	ASL
	CPY #01
	BNE &PBAT_05
	CLC
	ADC F2
	JMP &PBAT_06
&PBAT_05	CLC
	ADC :BP_FRAME,X
&PBAT_06	ADC :BAT_LO,Y	'#90
	STA F2
	LDA :BAT_HI,Y	'#99
	ADC #00
	STA F3
	LDX :BAT_BYTES,Y	'#$24
&PBAT_01	LDY :SOFS,X
	LDA (F0),Y	'AVOID OVERWRITING RIGHT-COLUMN
	BMI 04
	LDA (F2),Y
	STA (F0),Y
	DEX
	BPL &PBAT_01
	LDX ;BAT_X
	LDY :BP_FRAME,X
	BNE &PBAT_07
	LDA :XLOC,X
	BEQ &PBAT_04
	ADC #D9
	STA &PBAT_02+1
	LDA #40
	LDX #$04
&PBAT_03	LDY :SOFS,X
&PBAT_02	STA B300,Y
	DEX
	BPL &PBAT_03
&PBAT_04	LDA #F3
	STA B416
	STA B466
	RTS
&PBAT_07	CPY #05
	BNE &PBAT_04	'IF NOT FRAME 5
	LDY ;BAT_TYPE
	CPY #01
	BNE &PBAT_04        'IF NOT WIDE BAT
	CPX #$84
	BCS &PBAT_04        'IF TOO FAR RIGHT
	LDY :XLOC,X
	LDA #40
	STA B408,Y
	STA B458,Y
	LDA #F3
	STA B416
	STA B466
	RTS

&INIT_PLAYER_PULSE
	LDA ;BAT_X
	CLC
	ADC #$15
	TAX
	LDY #$117
	LDA #08
	STA EC
	LDA #00
&INIT_PULSE	'X=X Y=Y A=DIR
	STA F1
	STX F0
	LDX #07
&IPUL_01	LDA :ACTIVITY,X
	BMI &IPUL_02
	DEX
	BPL &IPUL_01
	RTS	'TOO MANY ACTIVE PULSES
&IPUL_02	LDA F1	'FOUND ONE
	STA :ACTIVITY,X
	LDA EC	'INITIAL LENGTH OF PULSOID
	STY EC
	TAY
	LDA :PULSE_HEAD,Y
	SEC
	SBC :PULSE_TAIL,Y
	CMP #$30
	BCS 04
	CMP #08
	BCS 02
	LDA #$08
	LDY EC
	STA :LENGTHEN_DELAY,X
	LDA #00
	STA :SHORTEN_DELAY,X
	TXA
	LSR
	ROR
	ROR
	ROR
	STA :PULSE_TAIL,X
	STA :PULSE_HEAD,X
	TAX
	TYA
	STA :STREAM_Y,X
	LDA F0
	STA :STREAM_X,X
	RTS


&SETUP_MREF
	LDX #$21
	LDA #80
&SUMR_01	STA 9D78,X	'TOP BORDER
	STA 9F9E,X	'BOTTOM BORDER
	DEX
	BPL &SUMR_01
	LDA #8E
	STA F0
	LDA #9D
	STA F1
	LDX #$24
&SUMR_02	LDA #80
	LDY #$21
	STA (F0),Y
	DEY
	LDA #3F
&SUMR_03	STA (F0),Y
	DEY
	BNE &SUMR_03
	LDA #80
	STA (F0),Y
	LDA #$22
	JSR &ADD_F0
	DEX
	BNE &SUMR_02
	RTS

&CLEAR_MREF
	LDA #49
	STA F0
	LDA #96
	STA F1
	LDX #$16
&CMAP_02	LDY #$19
	LDA #3F
&CMAP_01	STA (F0),Y
	DEY
	BPL &CMAP_01
	LDA #$22
	JSR &ADD_F0
	DEX
	BNE &CMAP_02
	RTS

&PLOT_MREF 	'X=LEVEL
	LDA :LEVEL_ADDRESS_LO,X
	STA F2
	LDA :LEVEL_ADDRESS_HI,X
	STA F3
	LDY #$00
	STY ;TILE_COUNT
&PMAP_02	LDA (F2),Y
	BMI &PMAP_04	'END SENTINAL FOUND
	STY F4
	LDX :MREF_ADDRESS_LO,Y
	STX F6
	LDX :MREF_ADDRESS_HI,Y
	STX F7
	LDX :MSCN_ADDRESS_LO,Y	'MIGHT ASWELL SORT ACT-SCN LOCATIONS NOW
	STX F8
	LDX :MSCN_ADDRESS_HI,Y
	STX F9
	LDY #00
	CMP #3F
	BEQ &PMAP_05
	CMP #26
	BEQ &PMAP_06
	INC ;TILE_COUNT	'ONLY INC IF <>3F AND <>26
&PMAP_06	CLC
	STA (F6),Y	'PLOT LEFT SIDE OF MAP_REF
	TAX
	ADC #01
	INY
	STA (F6),Y	'RIGHT-SIDE IS +1
	TXA
&PMAP_05	AND #3F	'DISCARD TOP 2 BITS
	CMP #3F	'CHECK IF BG
	BEQ &PMAP_03	'WAS BG, SO IGNORE
	STA F6
	LDA #98
	STA F7
	LDX #$09
&PMAP_01	LDY :SOFS,X
	LDA (F6),Y
	STA (F8),Y
	DEX
	BPL &PMAP_01
&PMAP_03	LDY F4
	INY
	CPY #$140
	BCC &PMAP_02
&PMAP_04	RTS

&DISPLAY_MREF 	'X=LEVEL
	LDA :LEVEL_ADDRESS_LO,X
	STA F2
	LDA :LEVEL_ADDRESS_HI,X
	STA F3
	LDY #$00
	STY ;TILE_COUNT
&DMAP_02	LDA (F2),Y
	BMI &DMAP_04	'END SENTINAL FOUND
	STY F4
	LDX :MREF_ADDRESS_LO,Y
	STX F6
	LDX :MREF_ADDRESS_HI,Y
	STX F7
	LDX :MSCN_ADDRESS_LO,Y	'MIGHT ASWELL SORT ACT-SCN LOCATIONS NOW
	STX F8
	LDX :MSCN_ADDRESS_HI,Y
	STX F9
	LDY #00
	LDA (F6),Y
	CMP #3F
	BEQ &DMAP_05
	CMP #26
	BEQ &DMAP_05
	INC ;TILE_COUNT	'ONLY INC IF <>3F AND <>26
&DMAP_05	AND #3F	'DISCARD TOP 2 BITS
	CMP #3F	'CHECK IF BG
	BEQ &DMAP_03	'WAS BG, SO IGNORE
	STA F6
	LDA #98
	STA F7
	LDX #$09
&DMAP_01	LDY :SOFS,X
	LDA (F6),Y
	STA (F8),Y
	DEX
	BPL &DMAP_01
&DMAP_03	LDY F4
	INY
	CPY #$140
	BCC &DMAP_02
&DMAP_04	RTS



&ADD_F0	CLC
	ADC F0
	STA F0
	BCC 03
	INC F1
	CLC
	RTS

&PULSE_DRIVER
	DEC ;PULSE_DELAY
	BNE &PCOR_04
	LDA ;PULSE_DREF
	STA ;PULSE_DELAY
	LDX #07
&PCOR_02	STX F2
	LDY :ACTIVITY,X
	STY FB
	BMI &PCOR_03
	LDA :ACTION_LO,Y
	STA &PCOR_01+1
	ADC ;RND_SEED
	STA ;RND_SEED
	LDA :ACTION_HI,Y
	STA &PCOR_01+2
	LDA #80
	STA F9
&PCOR_01	JSR BF00
	JSR &ALIEN_PULSE
	LDX F2
&PCOR_03	DEX
	BPL &PCOR_02
&PCOR_04	RTS

&ALIEN_PULSE
	LDX #03
&ALP_02	LDA :ALIEN_ACTION,X
	CMP #09
	BCC &ALP_01
	CMP #0D
	BCS &ALP_01
	LDA :ALIEN_X,X
	ADC #$06
	STA F0
	LDA :ALIEN_Y,X
	ADC #$05
	STA F1
	LDY F2
	LDA :ACTIVITY,Y
	BMI &ALP_01
	STA F3
	STY EC
	LDA :PULSE_HEAD,Y
	TAY
	LDA :STREAM_X,Y
	CMP :ALIEN_X,X
	BCC &ALP_01
	CMP F0
	BCS &ALP_01
	LDA :STREAM_Y,Y
	CMP :ALIEN_Y,X
	BCC &ALP_01
	CMP F1
	BCS &ALP_01
	PHA
	LDA #0D
	STA :ALIEN_ACTION,X
	PLA
	LDX :STREAM_X,Y     'GET START X POSITION
	TAY                 'GET START Y POSITION
	LDA F3		'ROTATE DIRECTION
	ADC #01
	AND #03
	JSR &INIT_PULSE	'X=X Y=Y A=DIR
	LDA #$15
	JSR &ADD_SCORE
&ALP_01	DEX
	BPL &ALP_02
	RTS




&CHECK_BYTE
	STX F4
	STY F5
&CBYT_03	LDA :MR_YLOCL,Y	'WE LOOK AT REFERENCE HIDDEN MAP WHICH CONTAINS 10*?? OF BORDERS,
	CLC
	ADC :XLOC,X
	STA F0              ''BLOCKS FOR LEVEL',ALIENS AND BATS.
	LDA :MR_YLOCH,Y     'THIS ALLOWS THE BOLT TO PASS THROUGH
	ADC #00
	STA F1              'STARS? AND BONUSES(AS THEY FALL) AND
	LDY #00             'IF NECCESARY... BOLTS THAT DOUBLE-BACK
	LDA (F0),Y          'ON THEMSELVES
	BMI &CBYT_01
	AND #3F
	CMP #3F	'IN HIDDEN MAP, BG IS ALWAYS #3F
	BEQ &CBYT_04
	LDA (F0),Y
&CBYT_01	LDX F2
	JSR &DETECT_EOL
	SEC
	RTS
&CBYT_04	LDX F2
	CLC
	LDA (F0),Y
	RTS

&DETECT_EOL
	PHA
	PHP
	LDA ;TILE_COUNT
	BNE &DEOL_01
	TYA
	PHA
	JSR &KILL_PULSE
	PLA
	TAY
&DEOL_01	LDX F2
	PLP
	PLA
	RTS


&CHECK_UR	LDY :PULSE_HEAD,X  'LOOK UR
	LDX :STREAM_X,Y
	LDA :STREAM_Y,Y
	TAY
	DEY      'UP
	INX      'RIGHT
	JMP &CHECK_BYT
&CHECK_DR	LDY :PULSE_HEAD,X  'LOOK UR
	LDX :STREAM_X,Y
	LDA :STREAM_Y,Y
	TAY
	INY
	INX
	JMP &CHECK_BYT
&CHECK_DL	LDY :PULSE_HEAD,X  'LOOK UR
	LDX :STREAM_X,Y
	LDA :STREAM_Y,Y
	TAY
	INY
	DEX
	JMP &CHECK_BYT
&CHECK_UL	LDY :PULSE_HEAD,X  'LOOK UR
	LDX :STREAM_X,Y
	LDA :STREAM_Y,Y
	TAY
	DEY
	DEX
	JMP &CHECK_BYT


&MOVE_UR	JSR &CHECK_UR
	JSR &RESERVE_HIT
	BCC &CHANGE_UR
	JSR &CHECK_DR
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_DR
	JSR &CHECK_UL
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_UL
	JSR &CHECK_DL
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	CLC
	JMP &CHANGE_DL
&MOVE_DR	JSR &CHECK_DR
	JSR &RESERVE_HIT
	BCC &CHANGE_DR
	JSR &CHECK_DL
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_DL
	JSR &CHECK_UR
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_UR
	JSR &CHECK_UL
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	CLC
	JMP &CHANGE_UL

&CHANGE_UR
	LDA #00
	STA :ACTIVITY,X
	JMP &PLOT_BYT
&CHANGE_DR
	LDA #01
	STA :ACTIVITY,X
	JMP &PLOT_BYT
&CHANGE_DL
	LDA #02
	STA :ACTIVITY,X
	JMP &PLOT_BYT
&CHANGE_UL
	LDA #03
	STA :ACTIVITY,X
	JMP &PLOT_BYT


&MOVE_DL	JSR &CHECK_DL
	JSR &RESERVE_HIT
	BCC &CHANGE_DL
	JSR &CHECK_DR
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_DR
	JSR &CHECK_UL
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_UL
	JSR &CHECK_UR
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	CLC
	JMP &CHANGE_UR
&MOVE_UL	JSR &CHECK_UL
	JSR &RESERVE_HIT
	BCC &CHANGE_UL
	JSR &CHECK_UR
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_UR
	JSR &CHECK_DL
	PHP
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	PLP
	BCC &CHANGE_DL
	JSR &CHECK_DR
	CMP #26
	BCS 03
	JSR &RESERVE_HIT
	CLC
	JMP &CHANGE_DR

&RESERVE_HIT
	PHP
	STA F9
	STA A1
	LDA F0
	STA F7
	LDA F1
	STA F8
	PLP
	RTS

&CTIL_09
	CMP #80
	BNE 05
	LDA #00
	STA BFE0
	RTS
&CTIL_06
'	LDA #01
'	STA BFE0
	RTS

&CHECK_TILE
'	LDA A1
'	JSR &TEST_2DH
	LDA A1
	BMI &CTIL_09	'BORDER
	CMP #3F
	BEQ &CTIL_06	'BG OR BAT
	STA E2
	AND #3F
	LSR       'GET LEFT TILE
	BCC &CTIL_01
	LDA F7
	SBC #01
	STA F7
	BCS 02
	DEC F8
&CTIL_01  LDX #00	'EFFECT TILE
&CTIL_04	LDA F7
	CMP :MREF_ADDRESS_LO,X
	BNE &CTIL_02
	LDA F8
	CMP :MREF_ADDRESS_HI,X
	BEQ &CTIL_03
&CTIL_02	INX
	CPX #$160
	BCC &CTIL_04
	RTS
&CTIL_03	LDA :MSCN_ADDRESS_LO,X
	STA E0
	LDA :MSCN_ADDRESS_HI,X
	STA E1
	LDA E2
	AND #3F
	LSR
	TAX
	LDA ;INVINCE_FLAG
	BNE &PROC_INVPULSE
&CTIL_08	LDA :TILE_VECTOR_LO,X
	STA &CTIL_07+1
	LDA :TILE_VECTOR_HI,X
	STA &CTIL_07+2
&CTIL_07	JMP BF00

&PROC_INVPULSE
	CPX #$19       	'CANNOT DELETE INDESTRUCTABLE
	BEQ &CTIL_08
	CPX #$04		'STILL SPEEDUP IF LIGHTNING
	BCS &PIP_01
	LDX #01
	JSR &INIT_LIGHTNING
&PIP_01	LDX F2
	LDA FB
	STA :ACTIVITY,X
	JMP &TV_CLEAR



&TV_LRED	LDA #$100
	JSR &ADD_SCORE
	LDX #01
	JSR &INIT_LIGHTNING
 	JMP &TV_CLR2
&TV_LGRN	LDA #$100
	JSR &ADD_SCORE
	LDX #01
	JSR &INIT_LIGHTNING
	JMP &TV_CLR2
&TV_LBLU	LDA #$100
	JSR &ADD_SCORE
	LDX #01
	JSR &INIT_LIGHTNING
	JMP &TV_CLR2
&TV_LMAG  LDA #$100
	JSR &ADD_SCORE
	LDX #01
	JSR &INIT_LIGHTNING
	JMP &TV_CLR2
&TV_ORED	LDA #$25
	JSR &ADD_SCORE
	LDA #05
	JMP &TV_CLEAR
&TV_OGRN  LDA #$25
	JSR &ADD_SCORE
	LDA #05
	JMP &TV_CLEAR
&TV_CLR2	LDA #02
&TV_CLEAR	STA BFE0
	LDA #40
	LDX #09
&CTIL_05	LDY :SOFS,X
	STA (E0),Y
	DEX
	BPL &CTIL_05
	LDY #00
	LDA #3F
	STA (F7),Y
	INY
	STA (F7),Y
	JSR &INIT_BONUS
	DEC ;TILE_COUNT
&TV_05	RTS


&TV_OBLU1	LDA #$10
	JSR &ADD_SCORE
	LDA #$14
	STA &TV_VCT01+1
	LDY #00
	STA (F7),Y
	INY
	LDA #$15
	STA (F7),Y
	LDA #06
	STA BFE0
	LDX #09
&TV_01	LDY :SOFS,X
&TV_VCT01	LDA 9800,Y
	STA (E0),Y
	DEX
	BPL &TV_01
	RTS
&TV_OBLU2 LDA #$25
	JSR &ADD_SCORE
	LDA #05
	JMP &TV_CLEAR
&TV_PRED	LDA #$25
	JSR &ADD_SCORE
	LDA #04
&TV_02	PHA
	JSR &GET_PULSE_LENGTH
	CMP #$28
	PLA
	BCS &TV_04
	STA :LENGTHEN_DELAY,X
&TV_04	LDA #09
	JMP &TV_CLEAR
&TV_PGRN  LDA #$25
	JSR &ADD_SCORE
	LDA #02
	JMP &TV_02
&TV_PBLU  LDA #$25
	JSR &ADD_SCORE
	LDA #03
	JMP &TV_02
&TV_MRED	LDA #$25
	JSR &ADD_SCORE
	JSR &GET_PULSE_LENGTH
	BCC &TV_03
	LDA #04
	STA :SHORTEN_DELAY,X
	LDA #08
&TV_03	JMP &TV_CLEAR
&TV_MGRN	LDA #$25
	JSR &ADD_SCORE
	JSR &GET_PULSE_LENGTH
	BCC &TV_03
	LDA #02
	STA :SHORTEN_DELAY,X
	LDA #08
	JMP &TV_CLEAR
&TV_MBLU	LDA #$25
	JSR &ADD_SCORE
	JSR &GET_PULSE_LENGTH
          BCC &TV_03
          LDA #03
          STA :SHORTEN_DELAY,X
	LDA #08
          JMP &TV_CLEAR
&TV_RCAGE	LDA #$50	'RED CAGE (REVERSE)
	JSR &ADD_SCORE
	LDA #FF
	STA ;REVERSE_FLAG
	LDA #$10
	JMP &TV_CLEAR
&TV_BCAGE LDA #$25	'BLUE CAGE (ICE)
	JSR &ADD_SCORE
	LDA #FF
	STA ;ICE_FLAG
	LDA #$10
	JMP &TV_CLEAR
&TV_RZED  LDA #$25
	JSR &ADD_SCORE
	LDA #$13
	JMP &TV_CLEAR
&TV_DITH1 LDA #$75
	JSR &ADD_SCORE
	LDA FB	'1ST HIT (BOUBLE-BACK PULSE)
	LDX F2
	LDY :ACTIVITY,X
	BMI 05
	EOR #02	'80=OFF 0=UR 1=DR 2=DL 3=UL  (DIRECTION)
	STA :ACTIVITY,X
&TV_DITH3	LDA #$36
	STA &TV_DITH4+1
	LDY #00
	STA (F7),Y
	INY
	LDA #$37
	STA (F7),Y
	LDX #09
&TV_DITH5	LDY :SOFS,X
&TV_DITH4	LDA 9800,Y
	STA (E0),Y
	DEX
	BPL &TV_DITH5
	RTS
&TV_DITH2 LDA FB	'2ND HIT (BOUBLE-BACK PULSE)
	LDX F2
	LDY :ACTIVITY,X
	BMI 05
	EOR #02	'80=OFF 0=UR 1=DR 2=DL 3=UL  (DIRECTION)
	STA :ACTIVITY,X
	LDA #$11
	JMP &TV_CLEAR
&TV_INDES LDA #00
	STA BFE0
	RTS	'INDESTRUCTABLE!

&INIT_LIGHTNING
	LDA :PULSE_SPEED,X
	STA ;PULSE_DREF
	LDA #FF
	STA ;LIGHTNING_FLAG
	RTS

&GET_PULSE_LENGTH
	LDX F2
	LDA :PULSE_HEAD,X
	CMP :PULSE_TAIL,X
	BCS 02         'EG H=30:T=20 OK
	ADC #$32       'EG H=02:T=30 (CYCLIC!)
	SEC
	SBC :PULSE_TAIL,X
	CMP #$10	'MINIMUM LENGTH IS 6
	RTS

&INIT_BONUS
	LDX #07
&IBON_01	LDA :BONUS_FRAME,X
	BMI &IBON_02
	DEX
	BPL &IBON_01
&IBON_03	RTS
&IBON_02  LDA E2	'BLOCK TYPE
	AND #3F
	LSR
	TAY
	LDA :BONUS_TYPE,Y	'TABLE HOLDS IMAGE ADRLO OR 0 FOR NO BONUS
	BEQ &IBON_03
	STA :BONUS_IMAGE,X
	LDA #0F
	STA :BONUS_FRAME,X
	LDA E1
	SEC
	SBC #A0
	STA E4
	LDA E0
	LDY #FF
	SEC
&IBON_04	INY
	SBC #$40
	BCS &IBON_04
	DEC E4
	SEC
	BPL &IBON_04
	ADC #$38
	STA :BONUS_X,X
	TYA
	STA :BONUS_Y,X
	RTS

&MANAGE_BONUS
	DEC ;BONUS_DELAY
	BNE &MBON_05
	LDA #C0
	STA ;BONUS_DELAY
	LDX #07
&MBON_01	LDA :BONUS_FRAME,X
	BMI &MBON_02
	STX F2
	JSR &MOVE_BONUS
	LDX F2
&MBON_02	DEX
	BPL &MBON_01
&MBON_05	RTS

&RESET_BAT
	LDA ;BAT_NORMALSPEED
	STA ;BAT_DREF
	LDA #00
	STA ;REVERSE_FLAG
	STA ;ICE_FLAG
	LDA ;BAT_TYPE
	CMP #01
	BNE &MBON_04
	LDA ;BAT_X	'CLEAR BAT RIGHT-SIDE (WAS WIDE BAT)
	TAX
	LDA :XLOC,X
	ADC #DE
	STA &MBON_08+1
	LDA #40
	LDX #$04
&MBON_07	LDY :SOFS,X
&MBON_08	STA B3DA,Y
	DEX
&MBON_06	BPL &MBON_07
&MBON_04	LDA #00		'RESET BAT TO ORIGINAL
	STA ;BAT_TYPE
	RTS


&MOVE_BONUS
	LDY :BONUS_FRAME,X
	INY
	CPY #$22
	BCC 02
	LDY #00
	TYA
	STA :BONUS_FRAME,X
	LDA :BONUS_MOVE,Y
	BEQ 03
	INC :BONUS_Y,X
	BMI &MVBN_04
	LDA :BONUS_REF,Y
	BEQ &MVBN_12
	STA &MVBN_02+1
	JMP &MVBN_06
&MVBN_12	LDA :BONUS_IMAGE,X
	STA &MVBN_02+1
	JMP &MVBN_06
&MVBN_04	LDA #80
	STA :BONUS_FRAME,X
	LDY :BONUS_Y,X
	DEY
&DELETE_BONUS
	LDA :SYLOCL,Y
	CLC
	ADC :BONUS_X,X
	STA F0
	LDA :SYLOCH,Y
	ADC #00
	STA F1
	LDX #$04
	LDA #40
&MVBN_08	LDY :SOFS,X
	STA (F0),Y
	DEX
	BPL &MVBN_08
	RTS
&MVBN_06	LDA :BONUS_X,X
	LDY :BONUS_Y,X
	CPY #$113		'REPLOT BAT WHEN BONUS IN VICINITY
	BCC &MVBN_10
	CPY #$124
	BCS &MVBN_10
	INC ;BAT_MOVED
	INC ;BONUS_OVERBAT	'ALSO MARK THAT BONUS IS BEHIND BAT
&MVBN_10	CLC
	ADC :SYLOCL,Y
	STA F0
	LDA :SYLOCH,Y
	ADC #00
	STA F1
	LDX #$04
&MVBN_01	LDY :SOFS,X
	LDA (F0),Y
	CMP #40    'PLOT ONLY WHERE BG=40 OR A0-BF
	BEQ &MVBN_02
	CMP #A0
	BCC &MVBN_03
	CMP #C0
	BCS &MVBN_03
&MVBN_02	LDA 9800,Y
	STA (F0),Y
&MVBN_03	DEX
	BPL &MVBN_01
	LDA ;BONUS_OVERBAT 'DETECT BONUS IS AT BAT HEIGHT
	BEQ &MVBN_07
	LDA #00
	STA ;BONUS_OVERBAT
	LDY ;BAT_X
	LDA :XLOC,Y
	CLC
	LDX ;BAT_TYPE
	ADC :BAT_WBYTES,X
	STA F0
	LDX F2
	LDA :BONUS_X,X
	CMP :XLOC,Y
	BCC &MVBN_07
	CMP F0
	BCS &MVBN_07
	LDA #00
	STA ;INVINCE_FLAG
	STA ;REVERSE_FLAG
	LDA #06
	STA B428
	STA B478
	LDA #80	 	'BONUS IS OVER BAT, SO STOP BONUS
	STA :BONUS_FRAME,X
	LDY :BONUS_Y,X
	JSR &DELETE_BONUS
	LDX #00
	LDA :PULSE_SPEED,X
	STA ;PULSE_DREF
	LDA #00
	STA ;REVERSE_FLAG
	STA ;ICE_FLAG
'	STA ;INVINCE_FLAG
	LDX F2
	LDA :BONUS_IMAGE,X	'THEN GET BONUS TYPE (E0-E7)
	SBC #DF		'-E0 BUT CARRY CLEAR
	BCC &MVBN_07	'ERROR
	TAX
	LDA :BONUS_VECTORL,X
	STA &MVBN_11+1
	LDA :BONUS_VECTORH,X
	STA &MVBN_11+2
&MVBN_11	JMP BF00
&MVBN_07	RTS


&BTYPE_E0	'L BIG BAT
	LDA #$15
	STA BFE0
	LDA #$10
	JSR &ADD_SCORE
	LDA ;BAT_TYPE
	AND #01
	BEQ 03
	JMP &RESET_BAT
	LDA #01
	STA ;BAT_TYPE
	LDA ;BAT_X
	CMP #$92
	BCC &BT_01
	LDA #$89
	STA ;BAT_X
&BT_01	RTS
&BTYPE_E1	'S
	LDA #$10
	JSR &ADD_SCORE
	JSR &RESET_BAT
	LDA ;BAT_VELO             'SET BAT SPEED TO DOUBLE
	STA ;BAT_DREF
	RTS
&BTYPE_E2	'C EAT PULSE
	LDA #$10
	JSR &ADD_SCORE
	JSR &RESET_BAT
	LDA #02
	STA ;BAT_TYPE
	RTS
&BTYPE_E3	'D SLOW DOWN
	LDA #$10
	JSR &ADD_SCORE
	LDX #02
	LDA :PULSE_SPEED,X
	STA ;PULSE_DREF
	JMP &RESET_BAT
&BTYPE_EXCESS	'EXCESS LIVES GIVE PLAYER 250 TO BONUS
	LDX CE
	LDA :BONUS2ADD,X
	ADC #$250
	BCC 02
	LDA #$255
	STA :BONUS2ADD,X
	JMP &RESET_BAT
&BTYPE_E4	'X XTRA LIFE
	LDA #$20
	JSR &ADD_SCORE
	LDX CE
	LDY CC,X
	CPY #$10
	BCS &BTYPE_EXCESS
	INY
	TYA
	STA CC,X
	JSR &DISPLAY_LIVES
	JMP &RESET_BAT
&BTYPE_E5	'= BARRIER
	LDA #$25
	JSR &ADD_SCORE
	LDA #$17
	STA BFE0
	LDA #$100
	STA ;BARRIER_FLAG
	LDX #$19
	LDA #FF
	JSR &FBAR_01
	JMP &RESET_BAT
&BTYPE_E6	'N
	LDA #$10
	JSR &ADD_SCORE
	LDA #$200            'SET TIMEOUT
	STA ;INVINCE_FLAG
	LDA #$16
	STA BFE0
	LDA #03		'PLOT YELLOW INKS
	STA B428
	STA B478
	JMP &RESET_BAT
&BTYPE_E7	': FIRE
	LDA #$100
	JSR &ADD_SCORE
	JMP &RESET_BAT


&ADD_SCORE
	STX A0
	PHP
	LDX CE
	CLC
	ADC :SCORE2ADD,X
	STA :SCORE2ADD,X
	PLP
	LDX A0
&SROUT_09	RTS

&SLOW_ROUTINES
	DEC ;SLOW_DELAY
	BNE &SROUT_09
	JSR &CYCLIC_COLOURS
	LDX CE
	LDA :BONUS2ADD,X
	BEQ &SROUT_05
	TAY
	LDA #00
	STA :BONUS2ADD,X
	TYA
&SROUT_05	PHA
	LDA :SCORE2ADD,X
	BEQ &SROUT_06
	TAY
	LDA #00
	STA :SCORE2ADD,X
	TYA
&SROUT_06	TAX
	PLA
	JSR &DO_SCORE
&SROUT_02 JSR &BARRIER_ROUTINE
	LDA ;LIGHTNING_FLAG
	BEQ &SROUT_01
	CMP #FF
	BNE &SROUT_07
	JSR &WHITE_ARENA
	JMP &SROUT_08
&SROUT_07 CMP #FC
	BNE &SROUT_08
	JSR &BLACK_ARENA
&SROUT_08	DEC ;LIGHTNING_FLAG
	BNE &SROUT_01
	LDX #00
	LDA :PULSE_SPEED,X
	STA ;PULSE_DREF
&SROUT_01	DEC ;BRINGEMON_DELAY
	BNE &SROUT_04
	LDA #C0
	STA ;BRINGEMON_DELAY
	JSR &ALIEN_INTRO
&SROUT_04	JSR &MANAGE_ALIENS
	LDA ;INVINCE_FLAG
	BEQ &SROUT_10
	DEC ;INVINCE_FLAG
	BNE &SROUT_10
	LDA #06
	STA B428
	STA B478
&SROUT_10	LDA ;REVERSE_FLAG
	BEQ &SROUT_11
	DEC ;REVERSE_FLAG
&SROUT_11	LDA ;ICE_FLAG
	BEQ &SROUT_03
	DEC ;ICE_FLAG
&SROUT_03	RTS

&BARRIER_ROUTINE
	LDA ;BARRIER_FLAG
	BEQ &FBAR_03
	LDA BF	'JSR &GET_KEY
	AND #04
	BEQ &FBAR_04
	STA ;BARRIER_UP
	LDA #$19
	STA BFE0
	DEC ;BARRIER_FLAG
	BNE &FBAR_05
	LDA #$18
	STA BFE0
	LDA #00
	STA ;BARRIER_FLAG
	STA ;BARRIER_UP
	LDX #$19
	LDA #40
	JMP &FBAR_01
&FBAR_05	LDA ;BARRIER_INVERSE
	EOR #01
	STA ;BARRIER_INVERSE
	BEQ &BARRIER_OFF
&BARRIER_ON
	LDX #$19
	LDA #C0
&FBAR_01	STA B632,X
	STA B682,X
	DEX
	BPL &FBAR_01
&FBAR_03	RTS
&FBAR_04	LDA #00
	STA ;BARRIER_UP
&BARRIER_OFF
	LDX #$19
	LDA #FF
	JMP &FBAR_01


'FIRE_ROUTINE
'	DEC ;FIRE_DELAY
'	BNE &
'	LDY #07
'	STY F2
'	LDX :FIRE_Y,Y
'	BEQ
'	LDA :SYLOCL,X
'	STA F0
'	LDA :SYLOCH,X
'	STA F1
'	LDX :FIRE_X,Y
'	LDY :XLOC,X
'	LDA :BITPOS,X
'	EOR (F0),Y
'	STA (F0),Y









&DISPLAY_LIVES
	LDX CE
	LDA :LIVES_SLOCHI,X
	STA &DLIFE_03+2
	LDA CC,X
	BNE 02
	LDA #01
	CLC
	ADC #AD
	STA &DLIFE_01+1
	LDX #04
&DLIFE_02	LDY :SOFS,X
&DLIFE_01	LDA 9900,Y
&DLIFE_03	STA 00C1,Y
	DEX
	BPL &DLIFE_02
	RTS

&DO_SCORE 	'A=BONUS TO ADD   X=SCORE TO ADD
	STX F1              'ADD SCORE
	PHA
	LDA CE		'SCORES ARE ARRANGED AS...
	ASL                 'P1 SCORE C0(LO)-C2
	ADC CE 	          'P2 SCORE C3(LO)-C5
	TAX                 'P1 BONUS C6(LO)-C8
	STA F0
	LDY #02             'P2 BONUS C9(LO)-CB
	SED                 'P1 LIVES CC
	CLC                 'P2 LIVES CD
&DOSC_01	LDA C0,X          'CURRENT PLAYER(0/1) CE
	ADC F1              'P1 FRESHMAN CF
	STA C0,X          'P2 FRESHMAN D0
	LDA #00             'HISCORE D1(LO)-D3
	STA F1              'P1 LEVEL D4
	INX                 'P2 LEVEL D5
	DEY
	BPL &DOSC_01
	LDY #02
	LDX F0		'NOW ADD BONUS
	PLA
	STA F1
	CLC
&DOSC_02	LDA C6,X
	ADC F1
	STA C6,X
	LDA #00
	STA F1
	INX
	DEY
	BPL &DOSC_02
	CLD
	LDA F0		'NOW PLOT SCORE (STARTING HI)
	ADC #02
	PHA
	TAX
	LDY CE
	LDA :SCORE_SLOCLO,Y
	STA F0
	LDA :SCORE_SLOCHI,Y
	STA F1
	LDY #02
&DOSC_03	LDA C0,X
	JSR &PLOT_LOHIDEC
	DEX
	DEY
	BPL &DOSC_03
	PLA		'NOW PLOT BONUS
	TAX
	LDY CE
	LDA :BONUS_SLOCLO,Y
	STA F0
	LDA :BONUS_SLOCHI,Y
	STA F1
	LDY #02
&DOSC_04	LDA C6,X
	JSR &PLOT_LOHIDEC
	DEX
	DEY
	BPL &DOSC_04
	RTS

&PLOT_LOHIDEC
	PHA
	LSR
	LSR
	LSR
	LSR
	JSR &PLOT_NUMERIC
	LDA #01
	JSR &ADD_F0
	PLA
	AND #0F
	JSR &PLOT_NUMERIC
	LDA #01
	JSR &ADD_F0
	RTS

&PLOT_NUMERIC
	STX F2
	STY F3
	CLC
	ADC #76
	STA &PNUM_01+1
	LDX #04
&PNUM_02	LDY :SOFS,X
&PNUM_01	LDA 9A00,Y
	STA (F0),Y
	DEX
	BPL &PNUM_02
	LDX F2
	LDY F3
	RTS










&CHECK_BAT  'DETECT BAT COMPLETELY HERE ONLY
	PHP
	LDA F5
	CMP #$127
	BCS &CBAT_04
	CMP #$117
	BCC &CBAT_03
	CMP #$124
	BCS &CBAT_03
	LDA F4
	SBC #05
	SEC
	SBC ;BAT_X
	BCC &CBAT_03
	LDY ;BAT_TYPE
	CMP :BAT_WIDTH,Y	'#$23
	BCS &CBAT_03	'TOO FAR RIGHT
	CMP #$05
	BCS &CBAT_01
	LDA #03		'LEFT FLANK
	STA :ACTIVITY,X
	JSR &CHECK_EAT
	INC F4
	INC ;BAT_MOVED	'PLOTS BAT
	PLP
	RTS
&CBAT_01	CMP :BAT_RFLANK,Y	'#$18
	BCC &CBAT_02
	LDA #00		'RIGHT FLANK
	STA :ACTIVITY,X
	JSR &CHECK_EAT
	DEC F4
	INC ;BAT_MOVED
	PLP
	RTS
&CBAT_02	LDA :ACTIVITY,X	'MIDDLE BAT
	EOR #01
	STA :ACTIVITY,X
	JSR &CHECK_EAT
	INC ;BAT_MOVED
&CBAT_03	PLP
	RTS
&CBAT_04  CMP #$149
	BCS &KPUL_04
	LDA ;BARRIER_UP
	BEQ &CBAT_03
	LDA :ACTIVITY,X
	BEQ &CBAT_03
	CMP #03
	BEQ &CBAT_03
	EOR #01
	STA :ACTIVITY,X
	PLP
	RTS
&KPUL_04  JSR &KILL_PULSE
	PLP
	RTS
&KILL_PULSE
	JSR &GET_PULSE_LENGTH
	CLC
	ADC #01
	STA :SHORTEN_DELAY,X
	LDA #01
	STA :PULSE_OFF,X
	RTS


&CHECK_EAT
	LDA ;BAT_TYPE
	CMP #02
	BNE &CEAT_01	'NOT EAT BAT
	JSR &GET_PULSE_LENGTH
	BCC &CEAT_01	'PULSE SHORT ENOUGH ALREADY
	SBC #$05
	STA SHORTEN_DELAY,X
	CLC
	LDX CE		'PLAYER NUMBER
	ASL
	ASL
	ADC :BONUS2ADD,X    'ONLY ADD BONUS HERE OTHERWISE EVERY OTHER SHORTEN
	STA :BONUS2ADD,X    'REASON WILL ADD TO BONUS!!
	LDX F2
	LDA #00
	STA ;BAT_TYPE
&CEAT_01	RTS



&KPUL_01	LDA #00
	STA :PULSE_OFF,X
	LDA #80
	STA :ACTIVITY,X
	LDY :PULSE_HEAD,X
	STX F2
	LDX :STREAM_Y,Y
	LDA :SYLOCL,X
	STA F0
	LDA :SYLOCH,X
	STA F1
	LDX :STREAM_X,Y
	LDY :XLOC,X
	LDA (F0),Y
	EOR :BITPOS,X
	STA (F0),Y
	LDX F2
	LDX #07
&KPUL_02	LDA :ACTIVITY,X
	BPL &KPUL_03
	DEX
	BPL &KPUL_02
	LDX CE
	LDA #01
	STA :EOL_FLAG,X
&KPUL_03	LDX F2
	RTS

&PLOT_BYT	JSR &CHECK_BAT
	LDA :PULSE_HEAD,X
	AND #%11100000
	STA F0
	LDA :PULSE_HEAD,X
	LDY :SHORTEN_DELAY,X
	BEQ &PBYT_02
	DEC :SHORTEN_DELAY,X
 	LDA :PULSE_OFF,X
	BEQ &PBYT_03
	LDA :SHORTEN_DELAY,X
	BEQ &KPUL_01
	JMP &PBYT_03
&PBYT_02	ADC #01             'TO SHORTEN BOLT, DELAY THIS INC
	AND #%00011111
	ORA F0
	STA :PULSE_HEAD,X
	TAY
	LDA F4		'NEW
	STA :STREAM_X,Y
	LDA F5
	STA :STREAM_Y,Y
	TAY
	LDA :SYLOCL,Y
	STA F0
	LDA :SYLOCH,Y
	STA F1
	LDX F4
	LDY :XLOC,X
	LDA (F0),Y
	ORA :BITPOS,X
	STA (F0),Y
	LDX F2
&PBYT_03	LDY :PULSE_TAIL,X
	LDX :STREAM_Y,Y
	LDA :SYLOCL,X
	STA F0
	LDA :SYLOCH,X
	STA F1
	LDX :STREAM_X,Y
	LDY :XLOC,X
	LDA (F0),Y
	BMI &PBYT_01
	AND :BITMSK,X
	STA (F0),Y
&PBYT_01	JSR &CHECK_TILE
	LDX F2
	LDA :PULSE_TAIL,X
	AND #%11100000
	STA F0
	LDA :PULSE_TAIL,X
	CLC
	LDY :LENGTHEN_DELAY,X
	BEQ &PBYT_04
	DEC :LENGTHEN_DELAY,X
	RTS
&PBYT_04	ADC #01             'TO LENGTHEN BOLT, DELAY THIS INC
	AND #1F
	ORA F0
	STA :PULSE_TAIL,X
	RTS

&BLACKEN_ARENA
	LDA #00
&PLOT_COLCOL
	STA F3
	LDA #$67
	STA F4
	LDA #59
	STA F0
	LDA #A2
	STA F1
	LDY #00
&PCC_01	LDA F3
	STA (F0),Y
	LDA #50
	JSR &ADD_F0
	DEC F4
	BNE &PCC_01
	RTS

:FADE_COLOUR
[040105020603070301030103]
&FADEIN_ARENA
	LDX #00
&FDIA_01	LDA :FADE_COLOUR,X
	JSR &PLOT_COLCOL
	LDA #20
	JSR &RUNTIME_DELAY
	INX
	CPX #0C
	BCC &FDIA_01
	RTS

&RUNTIME_DELAY
	PHA
	CLC
	LDA #00
&RUND_01	ADC #01
	NOP
	NOP
	BNE &RUND_01
	PLA
	SEC
	SBC #01
	BNE &RUNTIME_DELAY
	RTS



&ALIEN_INTRO
	LDX #03
&AI_01	LDA :ALIEN_ACTION,X
	BMI &AI_02
	DEX
	BPL &AI_01
	RTS
&AI_02	LDY CE
	LDA 00D4,Y
	AND #07
	CMP #05
	BCC 02
	SBC #03
	TAY
	LDA :ALIEN_GBASELO,Y
	STA :ALIEN_GFXLO,X
	LDA :ALIEN_GBASEHI,Y
	STA :ALIEN_GFXHI,X
	LDA #00
	STA :ALIEN_ACTION,X
	LDA #$73
	STA :ALIEN_X,X
	LDA #$03
	STA :ALIEN_Y,X
	RTS

&MANAGE_ALIENS
	DEC ;ALIEN_DELAY
	BNE &MAL_04
	LDA #03
	STA ;ALIEN_DELAY
	LDX #03
&MAL_03	LDY :ALIEN_ACTION,X
	BMI &MAL_02
	LDA :AA_VECTORLO,Y
	STA &MAL_01+1
	LDA :AA_VECTORHI,Y
	STA &MAL_01+2
	STX F2
&MAL_01	JSR BF00
	LDX F2
	JSR &RND_ALIENMOVES
&MAL_02	DEX
	BPL &MAL_03
&MAL_04	RTS


&RND_ALIENMOVES
	LDA :ALIEN_ACTION,X
	CMP #$09
	BCC &RNDAM_01
	CMP #$13
	BCS &RNDAM_01
	DEC :RND_DELAY,X
	BNE &RNDAM_01
	LDA #$18
	STA :RND_DELAY,X
	LDA ;RND_SEED
	AND #03
	ADC #09
	STA :ALIEN_ACTION,X
&RNDAM_01	RTS




&ALIEN_START       '00
	LDA #01
	STA :ALIEN_ACTION,X
	LDA #D0
	STA &AI_04+1
	LDA #$14
	STA BFE0
	RTS
&FADE_IN_4         '01
	LDA :ALIEN_GFXLO,X
	CLC
	ADC #06
	STA F0
	LDA :ALIEN_GFXHI,X
	STA F1
	INC :ALIEN_ACTION,X
	LDX #$09
&AI_03	LDY :SOF2,X
	LDA (F0),Y
	BPL 02
	EOR #BF
&AI_04	AND 9CD0,X
	ORA #40
	STA A083,Y
	DEX
	BPL &AI_03
	RTS
&FADE_IN_3         '02
	LDA #CE
	STA &AI_04+1
	JMP &FADE_IN_4
&FADE_IN_2         '03
	LDA #CC
	STA &AI_04+1
	JMP &FADE_IN_4
&FADE_IN_1         '04
	LDA #CA
	STA &AI_04+1
	JMP &FADE_IN_4
&FADE_IN_0         '05
	LDA #C8
	STA &AI_04+1
	JMP &FADE_IN_4
&MOVING_UP_INEYE   '06
	JSR &DELETE_AIE
	LDX F2
	DEC :ALIEN_Y,X	'NOW MOVE UP
	BEQ &AI_09
	JMP &PLOT_AIE
&AI_09	INC ALIEN_ACTION,X
	RTS

&MOVING_DOWN_INEYE '07
	JSR &DELETE_AIE
	LDX F2
	INC :ALIEN_Y,X
	JSR &PLOT_AIE
	LDX F2
	LDA :ALIEN_Y,X
	CMP #$15	'17
	BCC &AI_10
	JSR &DELETE_AOE
	LDX F2
	LDA #$62
	STA :ALIEN_X,X
	LDA #$06
	STA :ALIEN_Y,X
	LDA #$09
	STA :ALIEN_ACTION,X
&AI_10	RTS

&ON_SCREEN         '08
	RTS	'NOT CURRENTLY USED
&OS_MDOWN          '09
	LDA :ALIEN_Y,X	'LOOK DOWN FOR SPACE
	CMP #$110
	BCS &AI_11	'STAY BEFORE FOOT OF BAT
	ADC #06
	TAY
	LDA :ALIEN_X,X
	JSR &ALIEN_CHECKCOL
	BCS &AI_11
	INY
	JSR &ACHC_02
	BCS &AI_11
	JSR &DELETE_ALIEN
	LDX F2
	INC :ALIEN_Y,X
	INC :ALIEN_Y,X
	JMP &PLOT_ALIEN
&AI_11	LDA #0A	'TRY LEFT
	LDX F2
	STA :ALIEN_ACTION,X
	RTS
&OS_MLEFT          '0A
	LDY :ALIEN_X,X
	LDA :XLOC,Y
	DEY
	CMP :XLOC,Y
	BEQ &AI_12	'JUST MOVING WITHIN BYTE
	LDY :ALIEN_Y,X
	LDA :ALIEN_X,X
	SEC
	SBC #02
	STA F3
	JSR &ALIEN_CHECKCOL
	BCS &AI_13
	LDX F2
	LDA :ALIEN_Y,X	'CHECK THE ONE BELOW LEFT TOO
	ADC #05
	TAY
	LDA F3
	JSR &ALIEN_CHECKCOL
	BCS &AI_13
	JSR &DELETE_ALIEN
	LDX F2
&AI_12	DEC :ALIEN_X,X
	JMP &PLOT_ALIEN
&AI_13    LDA #0B	'TRY UP
	LDX F2
	STA :ALIEN_ACTION,X
	RTS
&OS_MUP            '0B
	LDY :ALIEN_Y,X
	DEY
	LDA :ALIEN_X,X
	JSR &ALIEN_CHECKCOL
	BCS &AI_14
	INY
	JSR &ACHC_02
	BCS &AI_14
	JSR &DELETE_ALIEN
	LDX F2
	DEC :ALIEN_Y,X
	DEC :ALIEN_Y,X
	JMP &PLOT_ALIEN
&AI_14	LDA #0C	'TRY RIGHT
	LDX F2
	STA :ALIEN_ACTION,X
	RTS
&OS_MRIGHT         '0C
	LDY :ALIEN_X,X
	LDA :XLOC,Y
	INY
	CMP :XLOC,Y
	BEQ &AI_15	'JUST MOVING WITHIN BYTE
	LDY :ALIEN_Y,X
	LDA :ALIEN_X,X
	CLC
	ADC #$12
	STA F3
	JSR &ALIEN_CHECKCOL
	BCS &AI_16
	LDX F2
	LDA :ALIEN_Y,X	'CHECK THE ONE BELOW RIGHT TOO
	ADC #05
	TAY
	LDA F3
	JSR &ALIEN_CHECKCOL
	BCS &AI_16
	JSR &DELETE_ALIEN
	LDX F2
&AI_15	INC :ALIEN_X,X
	JMP &PLOT_ALIEN
&AI_16    LDA #09	'TRY DOWN
	LDX F2
	STA :ALIEN_ACTION,X
	RTS
&FADE_OUT_0        '0D
&FADE_OUT_1        '0E
&FADE_OUT_2        '0F
&FADE_OUT_3        '10
&FADE_OUT_4        '11
&FADE_OUT_5        '12
&DISABLE_ALIEN     '13
	JSR &DELETE_ALIEN
	LDX F2
	LDA #80
	STA :ALIEN_ACTION,X
	LDA #$12
	STA BFE0
	RTS

&ALIEN_CHECKCOL	'Y=NEW Y-POS  /  A=NEW X-POS   / CS IF COLLISION FOUND
	PHA
	LDA :MR_YLOCL,Y
	STA F0
	LDA :MR_YLOCH,Y
	STA F1
	PLA
	TAY
	LDA :XLOC,Y
	TAY
&ACHC_02	LDA (F0),Y
	BMI &ACHC_01	'COLLISION WITH BORDER/BARRIER
	AND #3F
	CMP #3F
	BNE &ACHC_01	'COLLISION WITH BLOCK
	CLC
	RTS
&ACHC_01	SEC
	RTS

&DELETE_ALIEN
	LDX F2
	LDY :ALIEN_Y,X
	LDA ALIEN_X,X
	TAX
	LDA :SYLOCL,Y
	CLC
	ADC :XLOC,X
	STA F0
	LDA :SYLOCH,Y
	ADC #00
	STA F1
	LDA #40
	LDX #09
&AI_17	LDY :SOF2,X
	STA (F0),Y
	DEX
	BPL &AI_17
	RTS





&PLOT_ALIEN
	LDX F2
	LDY :ALIEN_Y,X
	LDA ALIEN_X,X
	TAX
	LDA :SYLOCL,Y
	CLC
	ADC :XLOC,X
	STA F0
	LDA :SYLOCH,Y
	ADC #00
	STA F1
	LDA :BP_FRAME,X
	ASL
	LDX F2
	ADC :ALIEN_GFXLO,X
	STA F4
	LDA :ALIEN_GFXHI,X
	STA F5
	LDX #09
&AI_18	LDY :SOF2,X
	LDA (F4),Y
	STA (F0),Y
	DEX
	BPL &AI_18
	RTS

&DELETE_AIE	'DELETE ALIEN INSIDE EYE
	LDY :ALIEN_Y,X
	TYA
	ASL
	ADC #DA
	STA &AI_06+1	'BMP
	LDA :AYLOCL,Y
	STA F0
	LDA :AYLOCH,Y
	STA F1
	LDX #09		'DELETE ALIEN
&AI_08	LDY :SOF2,X
&AI_06	LDA 9F00,X
	STA (F0),Y
	DEX
	BPL &AI_08
	RTS

&DELETE_AOE	'DELETE ALIEN OUTSIDE EYE
	LDY :ALIEN_Y,X
	LDA :AYLOCL,Y
	STA F0
	LDA :AYLOCH,Y
	STA F1
	LDA #40
	LDX #09		'DELETE ALIEN
&AI_19	LDY :SOF2,X
	STA (F0),Y
	DEX
	BPL &AI_19
	RTS


&PLOT_AIE	LDA :ALIEN_GFXLO,X
	CLC
	ADC #$06
	STA F4
	LDA :ALIEN_GFXHI,X
	STA F5
	LDY :ALIEN_Y,X
	TYA
	ASL
	STA F3
	ADC #B4
	STA &AI_05+1	'MSK
	LDA F3
	ADC #DA
	STA &AI_07+1	'BMP
	LDA :AYLOCL,Y
	STA F0
	LDA :AYLOCH,Y
	STA F1
	LDX #09		'DELETE ALIEN
&AI_08	LDY :SOF2,X
	LDA (F4),Y	'ALIEN GFX
	BPL 02
	EOR #BF
&AI_05	AND 9F00,X
&AI_07	ORA 9F00,X
	STA (F0),Y
	DEX
	BPL &AI_08
	RTS



'80 INACTIVE
'00 ALIEN INTRO
'01 FADE IN #4 (DARK)
'02 FADE IN #3
'03 FADE IN #2
'04 FADE IN #1
'05 FADE IN #0 (BRIGHT)
'06 MOVING UP IN EYE
'07 MOVING DOWN IN EYE
'08 ON SCREEN (OS) STILL (DECIDE WHICH AVAILABLE DIRECTION: L/R/U/D)
'09 OS: MOVING DOWN (PRIORITY IS TO HEAD TOWARDS BAT)
'0A OS: MOVING LEFT
'0B OS: MOVING UP
'0C OS: MOVING RIGHT
'0D FADE OUT #0 (BRIGHT)
'0E FADE OUT #1
'0F FADE OUT #2
'10 FADE OUT #3
'11 FADE OUT #4
'12 FADE OUT #5 (GONE!)
'13 DISABLE ALIEN

&PLOT_TITLE
	LDX #00
&PTIT_03	LDA :LEVEL_ADDRESS_LO,X
	STA F0
	LDA :LEVEL_ADDRESS_HI,X
	STA F1
	LDX #00	'Y POSITION
&PTIT_02	LDY #00
&PTIT_01	LDA (F0),Y
	CMP #"!"
	BEQ &PTIT_04
	JSR &PLOT_CHAR	'REG-Y=X POSITION  REG-X=Y POSITION  A=CHAR
	INY
	CPY #$20
	BCC &PTIT_01
	LDA #$20
	JSR &ADD_F0
	INX
	CPX #$16
	BCC &PTIT_02
&PTIT_04	RTS

&DISPLAY_HSCC
	DEC ;CF_COUNT
	BNE &DHCC_02
	LDX ;COL_FADE
	INX
	CPX #$12
	BCC 02
	LDX #00
	STX ;COL_FADE
	LDA :COLOUR_FADE,X
	LDX #04
&DHCC_01	LDY :SOFS,X
	STA A3C4,Y
	DEX
	BPL &DHCC_01
&DHCC_02	RTS




&PLOT_CHAR	'REG-Y=X POSITION  REG-X=Y POSITION  A=CHAR
	STX F2
	STY F3
	PHA
	SEC
	SBC #30
	TAY
	LDA :CHAR_ADDRLO,Y
	STA F4
	LDA :CHAR_ADDRHI,Y
	STA F5
	LDA F3
	CLC
	ADC :TYLOCL,X
	STA F6
	LDA :TYLOCH,X
	ADC #00
	STA F7
	PLA
	CMP #20
	BEQ &PCHR_02
	LDX #04
&PCHR_01	LDY :SOFS,X
	LDA (F4),Y
	STA (F6),Y
	DEX
	BPL &PCHR_01
	LDX F2
	LDY F3
	RTS

&PCHR_02	LDX #04
	LDA #40
&PCHR_03	LDY :SOFS,X
	STA (F6),Y
	DEX
	BPL &PCHR_03
	LDX F2
	LDY F3
	RTS

'A=VALUE
'RETURNS X=TENS A=UNITS
&CALC_DECIMAL
	LDX #2F
	SEC
&PDEC_01	INX
	SBC #$10
	BCS &PDEC_01
	ADC #$58
	RTS


&PLOT_DECIMAL	'A=VALUE X=X Y=Y
	STX F2
	JSR &CALC_DECIMAL
	PHA
	TXA
	LDX F2
	JSR &PLOT_CHAR
	PLA
	INY
	JMP &PLOT_CHAR

&PLOT_3DD	STX F2
	LDX #2F
	SEC
&P3DD_01	INX
	SBC #$100
	BCS &P3DD_01
	ADC #$100
	PHA
	TXA
	LDX F2
	JSR &PLOT_CHAR
	PLA
	INY
	JMP &PLOT_DECIMAL

&WHITE_ARENA
	JSR &SETUP_F0
&WAREN_01	LDY #$21
	LDA #10
	STA (F0),Y
	LDY #$00
	LDA #17
	STA (F0),Y
	LDA #$80
	JSR &ADD_F0
	DEX
	BNE &WAREN_01
	RTS

&BLACK_ARENA
	JSR &SETUP_F0
&WAREN_02	LDY #$00
	LDA #03
	STA (F0),Y
	LDY #$21
	LDA #04
	STA (F0),Y
	LDA #$80
	JSR &ADD_F0
	DEX
	BNE &WAREN_02
	RTS

&SETUP_F0 LDA #59
	STA F0
	LDA #A2
	STA F1
	LDX #40
	RTS

&WIPE_ARENA
	LDA #5A
	STA F0
	LDA #A2
	STA F1
	LDA #62
	STA F2
	LDA #B8
	STA F3
	LDX #$71
&WARE_02	LDY #$19
	LDA #40
&WARE_01	STA (F0),Y
	STA (F2),Y
	DEY
	BPL &WARE_01
	LDA #$80
	JSR &ADD_F0
	LDA F2
	SEC
	SBC #$80
	STA F2
	LDA F3
	SBC #00
	STA F3
	LDA #03
	JSR &RUNTIME_DELAY
	DEX
	BNE &WARE_02
	RTS

&PRESENT_LEVEL
	LDX CE		'DISPLAY SCREEN NUMBER
	LDA D4,X
	LDX #03	'Y-POSITION	'SCREEN XX
	LDY #$13	'X-POSITION
	JSR &PLOT_DECIMAL
	LDA #05			'DISPLAY TEXT
	STA F9
	LDX #03
	LDY #00
&NLEV_01	LDA :MSG_SCREEN,Y
	STY F8
	LDY F9
	JSR &PLOT_CHAR
	LDY F8
	INC F9
	INY
	CPY #06
	BCC &NLEV_01
	LDX #00	'Y-POSITION	'PLAYER XX
	LDY #$13	'X-POSITION
	LDA CE
	ADC #00
	JSR &PLOT_DECIMAL
	LDA #05			'DISPLAY TEXT
	STA F9
	LDX #00
	LDY #00
&NLEV_02	LDA :MSG_PLAYER,Y
	STY F8
	LDY F9
	JSR &PLOT_CHAR
	LDY F8
	INC F9
	INY
	CPY #06
	BCC &NLEV_02
	LDA #01			'DISPLAY TEXT
	STA F9
	LDX #06                       'PRESS FIRE TO PLAY
	LDY #00
&NLEV_05	LDA :MSG_PRESSFIRE,Y
	STY F8
	LDY F9
	JSR &PLOT_CHAR
	LDY F8
	INC F9
	INY
	CPY #$18
	BCC &NLEV_05
&NLEV_06	JSR &CLEAR_KBDBUFFER
&NLEV_04	DEC ;CYCLIC_DELAY
	BNE 08
	LDA #08
	JSR &RUNTIME_DELAY
	JSR &CYCLIC_COLOURS
	LDA BF        'WAIT FOR FIRE
	AND #04
	BEQ &NLEV_04
	JSR &WIPE_ARENA		'THEN CLEAR SCREEN AGAIN
&NLEV_07	LDX #$01
	JSR &GET_MESSADDRESS
	LDX CE		'DISPLAY SCREEN NUMBER IN MESSAGE AREA
	LDA D4,X
	JSR &CALC_DECIMAL
	LDY #$32
	STA (62),Y
	DEY
	TXA
	STA (62),Y
	LDY #$16
	LDA ;PC_DIFFICULTY
	ASL
	ASL
	ASL
	TAX
&NLEV_03	LDA :DIFFICULTY_TEXT,X
	STA (62),Y
	INX
	INY
	CPY #$24
	BCC &NLEV_03
	LDX #$01
	LDY #$193
	LDA #01
	JMP &PLOT_MESSAGE





&PLAY_PLAYER
	JSR &PLOT_BAT       'PLOT BAT
	JSR &FADEIN_ARENA   'FADE SCREEN IN
	JSR &INIT_PLAYER_PULSE
	LDX #00
	LDA :PULSE_SPEED,X
	STA ;PULSE_DREF
	STX ;INVINCE_FLAG
&DRV_01	JSR &BAT_MOVE
	JSR &COND_BAT
	JSR &PULSE_DRIVER
	JSR &MANAGE_BONUS
	JSR &SLOW_ROUTINES
	LDX CE
	LDA :EOL_FLAG,X
	BEQ &DRV_01
	JSR &BLACK_ARENA
	LDA ;TILE_COUNT
	BNE &DRV_04
	JMP &NEXT_LEVEL
&DRV_04	LDA #$03		'JUST_DIED
	STA BFE0
	JSR &RESET_BAT
	JSR &WIPE_ARENA	'WIPE ARENA
	LDX CE            'RESET BONUS
	TXA
	ASL
	ADC CE
	TAX
	LDA #00
	STA C6,X
	STA C7,X
	STA C8,X
	LDX #00             'PLOT SCORE&BONUS
	TXA
	JSR &DO_SCORE
	LDA #00		'RESET EOL FLAG
	LDX CE
	STA :EOL_FLAG,X
	LDA #$49		'CENTRE BAT
	STA ;BAT_X
	DEC CC,X	'DECREMENT LIVES
	BNE &JDED_01	'DEAD!
	JSR &REPORT_DEATH
&JDED_01	JSR &DISPLAY_LIVES
	RTS

&CYCLIC_COLOURS
'	DEC ;XTRA_SLOW
'	BNE &CCL_02
	LDX ;COLOUR_CYCLE
	STX F1
	INX
	CPX #0C
	BCC 02
	LDX #00
	STX ;COLOUR_CYCLE
	LDA :COLOUR_FADE,X
	LDX #04
&CCL_01	LDY :SOFS,X
	STA BE28,Y
	STX F0
	LDX F1
	INX
	CPX #0C
	BCC 02
	LDX #00
	STX F1
	LDA :COLOUR_FADE,X
	LDX F0
	DEX
	BPL &CCL_01
&CCL_02	RTS


&REPORT_DEATH
	LDA #05			'DISPLAY SCREEN TEXT
	STA F9
	JSR &DISABLE_ALL_ACTIVITIES
	LDX #00
	LDY #00
&JDED_02	LDA :MSG_GAMEOVER,Y
	CMP #20
	BEQ &JDED_03
	STY F8
	LDY F9
	JSR &PLOT_CHAR
	LDY F8
&JDED_03	INC F9
	INY
	CPY #09
	BCC &JDED_02
	LDA #80
	JSR &RUNTIME_DELAY		'DELAY 'SCREEN XX'
	JMP &WIPE_ARENA		'THEN CLEAR SCREEN AGAIN


&NEXT_LEVEL	'PLAYER DEPENDANT
	JSR &RESET_BAT
&NXTL_01	LDA CE
	ASL
	ADC CE
	TAX
	SED
	SEC
	LDA C8,X
	BNE &NXTL_04
	LDA C7,X
	BNE &NXTL_04
	LDA C6,X
	BEQ &NXTL_02
&NXTL_04	LDA C6,X
	SBC #01
	STA C6,X
	LDA C7,X
	SBC #00
	STA C7,X
	LDA C8,X
	SBC #00
	STA C8,X
	LDA C0,X
	CLC
	ADC #01
	STA C0,X
	BCC &NXTL_03
	LDA C1,X
	ADC #00
	STA C1,X
	BCC &NXTL_03
	LDA C2,X
	ADC #00
	STA C2,X
&NXTL_03	CLD
	LDA #00
	TAX
	JSR &DO_SCORE
	JSR &CYCLIC_COLOURS
	LDA CE
	ASL
	ADC CE
	TAX
	LDA #$14
	LDY C7,X
	BEQ 02
	LDA #$04
&NXTL_06	JSR &RUNTIME_DELAY
	LDA #05
	STA BFE0
	JMP &NXTL_01
&NXTL_02	CLD
	LDX CE
	LDA #00
	STA :EOL_FLAG,X
	LDA D4,X
	CLC
	ADC #01
	CMP #$49
	BCC &NXTL_05
	LDA ;PC_DIFFICULTY
	CMP #03
	BCS 02
	ADC #01
	STA ;PC_DIFFICULTY
	JSR &UPDATE_DIFF
	LDX CE
	LDA #10
	STA C7,X
	LDA #01
&NXTL_05	STA D4,X
	LDA #$49
	STA ;BAT_X
	JSR &WIPE_ARENA		'CLEAR SCREEN
	JSR &PRESENT_LEVEL
	JSR &DISABLE_ALL_ACTIVITIES
	JSR &SETUP_MREF
	JSR &SETUP_NEW_LEVEL
	JMP &PLAY_PLAYER





&DISABLE_ALL_ACTIVITIES
	LDX #07
	LDA #80
&DAAC_01	STA :ACTIVITY,X   	'DISABLE PULSES
	STA :BONUS_FRAME,X	'DISABLE BONUSES
	DEX
	BPL &DAAC_01
	LDX #03
&DAAC_02	STA :ALIEN_ACTION,X
	DEX
	BPL &DAAC_02
	RTS






'******************************************************************************
'


&SETUP_SFXIRQ
	SEI
	LDA #7F	'ENABLE JUST T1 IRQ
	STA 030E
	LDA #C0
	STA 030E
	LDA #10	'SET T1 AT 10000
	STA 0306
	LDA #27
	STA 0307
	LDX #07	'REDIRECT IRQ VECTOR
	LDA :PC_VECTORL,X
	STA 0245
	LDA :PC_VECTORH,X
	STA 0246
	LDA #00	'INIT SFX
	LDX #0E
&SUSI_01	STA B1,X
	DEX
	BPL &SUSI_01
	STX BFE0	'RESET SFX
	CLI
	RTS




&SFX_IRQ	PHA      'CHECK FOR NEW EFFECT
	TYA
	PHA
	LDA ;AUDIO_FLAG
	BNE &CSI_08
	LDA #FF	'NO AUDIO, BUT STILL NEED TO READ KBD
	STA 030C
	JMP &CSI_09
&CSI_08	LDA BFE0
	BMI &CSI_01
	STA BFFF
	ASL
	ASL
	TAY
	LDA #00
	STA BFE7
	STA BFE8
	STY B0
	LDA #80
	STA BFE0
	LDA 9180,Y
	AND #07
	ASL
	ASL
	ASL
	STA B1
	LDA 9180,Y
	AND #08
	STA B2
	LDA 9180,Y
	AND #F0
	STA B3
	STA B4
	LDA 9181,Y
	AND #0F
	STA B5
	STA B6
	LDA 9181,Y
	LSR
	LSR
	LSR
	LSR
	STA B7
	STA B8
	LDA 9182,Y
	STA BB
	AND #7F
	STA B9
	JSR &CALC_PITCH
	AND #0F
	STA BD
	STY BE
	LDY B0
'	LDA 9182,Y
'	BPL 04
	LDA #%01111100	'CHB ON
'	BNE 02
'	LDA #%01111110      'CHB OFF
	STA BFE6
	LDA 9183,Y
	LSR
	STA BA
&CSI_01	DEC B5		'PROCESS VOLSEQ
	BPL &CSI_04
	LDA B6
	STA B5
	LDY B1
	LDA 9100,Y
	BEQ &CSI_04
	AND #0F
	STA BFE7
	STA BFE8
	LDA 9100,Y
	AND #F0
	LSR
	LSR
	LSR
	STA BFE5
	BEQ &CSI_02
	LDA BFE6
	AND #%11100111
	STA BFE6
	JMP &CSI_03
&CSI_02	LDA BFE6
	ORA #%00011000
	STA BFE6
&CSI_03	INC B1
&CSI_04   DEC B7		'PROCESS ORNAMENT
	BPL &CSI_07
	LDA B8
	STA B7
	LDY B3
	LDA 9000,Y
	BNE &CSI_05
	LDA B2
	BEQ &CSI_07
	LDY B4
	STY B3
	CLC
	LDA 9000,Y
'	BEQ &CSI_07
&CSI_05   BMI &CSI_06	'PITCH OFFSET
	ADC B9
	AND #7F
	JSR &CALC_PITCH	'Y=HI A=LO
	STA BFE1
	STY BFE2
	CLC
	ADC BA
	STA BFE3
	BCC 01
	INY
	STY BFE4
	JMP &CSI_07
&CSI_06	ADC BD
	STA BFE1
	LDA BE
	ADC #00
	AND #0F
	STA BFE2
	LDA BFE1
	ADC BA
	STA BFE3
	LDA BFE2
	ADC #00
	AND #0F
	STA BFE4
&CSI_07	INC B3
&SEND_AY	LDY #07		'SEND AY REGISTER
&SAY_01	LDA :AY_REGISTER,Y
	STA 030F
	LDA #FF
	STA 030C
	LDA #DD
	STA 030C
	LDA BFE1,Y
	STA 030F
	LDA #FD
	STA 030C
	LDA #DD
	STA 030C
	DEY
	BPL &SAY_01
	STY 030C		'CHECK ON KEY READ
&CSI_09	DEC ;KEY_DELAY
	BEQ &SAY_06
	JMP &SAY_03
&SAY_06	LDA #04
	STA ;KEY_DELAY
	LDA #00
	STA BF
	LDA #0E             'READ THE KEYBOARD
	STA 030F
	LDA #FD
	STA 030C
	LDA ;PC_PLAY_CTRL	'WRITE COLUMN 0 IF PASE/ALTAI
	LDY #03		'TO PREVENT COLUMN CORRUPTION
	CMP #01
	BNE &SAY_08
	LDA #00
	STA 030F
	DEY		'STORE KEY_COL INTO 020F INSTEAD!!
&SAY_08	STY &SAY_07+2
	LDY #04
&SAY_02	LDA :KEY_COL,Y
&SAY_07	STA 030F
	LDA :KEY_ROW,Y
	STA 0300
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	LDA 0300
	AND #08
	BEQ &SAY_04
	LDA BF
	ORA :KEY_BIT,Y      'REGISTER THE KEY
	STA BF
&SAY_04	DEY
	BPL &SAY_02
	LDA ;PC_PLAY_CTRL
	CMP #01	'CHECK IF JOYSTICK CHOSEN
	BNE &SAY_03
	LDA ;OPERATING_SYSTEM	'0=TELE 10=ORIC 20=EUPH
	BEQ &SAY_05
	LDA BF	PASE...
	AND #%11111000	'TAKE OUT L/R/F
	STA BF
	LDA #C0	'SET DDRA
	STA 0303
	LDA #80	'
	LDY CE	'NOW DECIDE WHICH PLAYER(JOYSTICK)
	BEQ 02
	LDA #40
	STA 030F
	LDA 030F	'GET JOYSTICK BYTE
	EOR :JOYSTICK_MASK,Y	'BF OR 7F
	AND #23   'EXCLUDE U/D
	CMP #20	'LOOK FOR FIRE
	BCC 02
	EOR #24	'REMOVE B5, ADD B2 FOR FIRE
	ORA BF    'COMBINE WITH PAUSE AND ESCAPE KEYS
	STA BF
	LDA #FF	'RESTORE DDRA
	STA 0303
	JMP &SAY_03
&SAY_05	LDA #40	'SELECT CORRECT TELESTRAT JOYSTICK FOR PLAYER
	LDY CE
	BNE 02
	LDA #80
	STA 0320
	NOP
	NOP
	LDA 0320
	AND #1F
	TAY
	LDA :JOY_CODE,Y
	ORA BF
	STA BF
	LDA 032F	'SECOND BUTTON ON TELESTRAT JOYSTICK FOR PAUSE
	AND #80
	EOR #80	'NORMALLY ON
	LSR       'SHIFT TO 0/8
	LSR
	LSR
	LSR
	ORA BF
	STA BF
&SAY_03	LDA #DD
	STA 030C
	LDA 0304	'RESET IRQ
	PLA
	TAY
	PLA
	RTI


&CALC_PITCH
	AND #7F
	LDY #FF
	SEC
&FNT_01	INY
	SBC #0C
	BCS &FNT_01
	ADC #0C
	STY BB
	TAY
	LDA :BASE_NOTE_LO,Y
	STA BC
	LDA :BASE_NOTE_HI,Y
	LDY BB
	BEQ &FNT_03
&FNT_02	LSR
	ROR BC
	DEY
	BNE &FNT_02
&FNT_03	TAY
	LDA BC
	RTS


'&MANAGE_SS
'
'
'SSC_01

&TEST_2DH	STX 90
	STY 93
	PHA
	PHA
	LSR
	LSR
	LSR
	LSR
	JSR &CALC_HEX
	LDX #00
	JSR &PLOT_DIGIT
	PLA
	AND #0F
	JSR &CALC_HEX
	LDX #01
	JSR &PLOT_DIGIT
	PLA
	LDX 90
	LDY 93
	RTS

&PLOT_DIGIT
	TXA
	CLC
	ADC #26
	STA &PD_02+1
	LDX #04
&PD_03	LDY :SOFS,X
&PD_01	LDA BF00,Y
&PD_02	STA BE26,Y
	DEX
	BPL &PD_03
	RTS


&CALC_HEX	CMP #0A
	BCS &CH_01
	ADC #AE
	LDX #99
&CH_05	STA &PD_01+1
	STX &PD_01+2
	RTS
&CH_01	CMP #0E
	BCS &CH_02
	ADC #CA
&CH_04	LDX #98
	JMP &CH_05
&CH_02	BNE &CH_03
	LDA #EF
	JMP &CH_04
&CH_03	LDA #44
	LDX #9B
	JMP &CH_05

&SETUP_MUSIC
	SEI
	JSR 7DD9  'SETUP MUSIC
	LDA #7F	'SETUP T1/T2 IRQ
	STA 030E
	LDA #E0
	STA 030E
	LDA #27
	STA 0307
	LDA #10	'SETUP T1 SID
	STA 0306
	LDA #27
	STA 0309
	LDA #10	'SETUP T2 100 HZ (10000)
	STA 0308
	LDA #DD
	STA 030C
	LDA #07	'SETUP SID REGISTER STAT
	STA 030F
	LDA #FF
	STA 030C
	LDA #DD
	STA 030C
	LDX #08	'REDIRECT IRQ TO NEW MUSIC VECTOR
	LDA :PC_VECTORL,X
	STA 0245
	LDA :PC_VECTORH,X
	STA 0246
	LDA #4C
	STA 0244
	CLI
	RTS

&MUSIC_IRQ
	STA B0
	BIT 030D
'BIT WILL TRANSFER T1 TIMEOUT FLAG INTO B6 (V)
'SINCE ONLY TWO IRQ'S EXIST...
'0 T2 TIMEOUT (B5)
'1 T1 TIMEOUT (B6)
'
	BVC &MIRQ_01	'PROCESS MUSIC
&MIRQ_08	LDA 8FE3	'FETCH REFERENCE STAT
	EOR #06
	STA 030F
	STA 8FE3	'MAKE SURE WE STORE IT AGAIN
	LDA #FD	'SEND IT
	STA 030C
	LDA #DD
	STA 030C
	LDA 0304	'RESET IRQ
	LDA B0	'RESTORE REGISTERS
	RTI

&MIRQ_01	STX B4
	LDA ;AUDIO_FLAG
	BNE &MIRQ_06
	JSR &SILENCE_SOUND
	JMP &MIRQ_07
&MIRQ_06  JSR 7DFE	'PROCESS MUSIC
'SID FREQ ALWAYS ON B, ALWAYS BC STAT
	LDX #00	'C WHEN EVENT 14-24 OTHERWISE B FOR PITCH
	LDA BFFA
	CMP #$14
	BCC &MIRQ_02
	CMP #$25
	BCS &MIRQ_02
	LDX #02
&MIRQ_02	LDA 8FDF,X	'B HI
	STA B2
	LDA 8FDE,X	'B LO
	ASL
	ROL B2
	ASL
	ROL B2
	ASL
	ROL B2
	ASL
	ROL B2
'	ADC #10
	STA 0306
	LDA B2
'	ADC #00
	STA 0307
&MIRQ_07	DEC B3	'NOW CHECK KEYBOARD
	BMI 03
	JMP &MIRQ_10
	LDA #$05	'KEYBOARD CHECKED EVERY 10 MS
	STA B3
	LDA #00
	STA BF
	LDA #0E
	STA 030F
	LDA #FF
	STA 030C
	LDA #FD
	STA 030C
	LDX #06
&MIRQ_03	LDA :PC_KCOL,X
	STA 030F
	LDA :PC_KROW,X
	STA 0300
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	LDA 0300
	AND #08
	BNE &MIRQ_04
	DEX
	BPL &MIRQ_03
	JMP &MIRQ_05
&MIRQ_04  INX
	STX BF
&MIRQ_05	LDA ;PC_PLAY_CTRL	'CHECK FOR JOYSTICK
	CMP #01
	BNE &MIRQ_10
	LDA ;OPERATING_SYSTEM	'CHECK FOR SYSTEM
	BEQ &MIRQ_11
'PASE, DETECT EITHER JOYSTICK BUTTON
	LDA #C0	'SET DDRA
	STA 0303
	LDA #80	'SET JOY-A
	STA 030F
	LDA 030F	'GET JOY DATA BYTE
	AND #20	'EXTRACT FIRE
	BNE 04
	LDA #05	'SET KEY
	STA BF
	LDA #FF	'RESTORE DDRA
	STA 0303
	JMP &MIRQ_10
&MIRQ_11	LDA #80  		'DETECT LEFT TELESTRAT JOYSTICK FIRE
	STA 0320
	NOP
	NOP
	LDA 0320
	AND #1F
	TAX
	LDA :JOY_CODE,X
	AND #04
	BEQ 04
	STA BF	'SHOULD RETURN 5, NOT 4
	INC BF
&MIRQ_10	LDX B4
	LDA #07	'RESTORE SID STAT REGISTER
	STA 030F
	LDA #FF
	STA 030C
	LDA #DD
	STA 030C
	LDA #27  	'RESET T2 IRQ 100 HZ
	STA 0309
	BIT 030D
	BVC &MIRQ_09	'PROC SID AFTERWARDS
	JMP &MIRQ_08
&MIRQ_09	LDA B0	'RESTORE REGISTERS
	RTI

&SILENCE_SOUND
	LDX #0A
&SLS_01	STX 030F
	LDA #FF
	STA 030C
	LDA #DD
	STA 030C
	CPX #07
	BEQ &SLS_02
	LDA #00
	STA 030F
	LDA #FD
	STA 030C
	LDA #DD
	STA 030C
	DEX
	JMP &SLS_01
&SLS_02	LDA #7F
	STA 030F
	LDA #FD
	STA 030C
	LDA #DD
	STA 030C
	RTS

&MANAGE_SCROLLER
	DEC ;CYCLIC_DELAY
	BNE 03
	JSR &CYCLIC_COLOURS
&MSC_02	LDA ;SCROLL_FLAG
	BEQ &MSC_01
	DEC ;SCROLL_CNT
	BNE &MSC_01
	LDA ;SCROLL_REF
	STA ;SCROLL_CNT
	JSR &SCROLL_TEXT
	JSR &POPULATE_RIGHT_COLUMN
&MSC_01	RTS

&SCROLL_TEXT
	LDA #29
	STA 70
	LDA #BE
	STA 71
	LDX #05
	CLC
&SCT_02	LDY #24
&SCT_01	LDA (70),Y
	ROL
	CMP #C0
	AND #7F
	ORA #40
	STA (70),Y
	DEY
	BPL &SCT_01
	JSR &NL_70
	DEX
	BNE &SCT_02
	RTS

'72 BIT COUNT
'73 TEMP
'74-75 LOCATION OF CHAR DEFINITION
'76-77 BASE OF TEXT MESSAGE
'78 TEXT MESSAGE OFFSET (0-255)
&POPULATE_RIGHT_COLUMN
	LDX 72	'6 COUNT
	LDA ;WIDE_COUNT
	EOR #01
	STA ;WIDE_COUNT
	BEQ 01
	DEX
	BPL &PRC_05
	LDX #05
	LDY 78
	INY
&PRC_03	LDA (76),Y
	CMP #"!"	'TEXT MESSAGES ARE TERMINATED WITH !
	BNE &PRC_04
	LDY #00
	JMP &PRC_03
&PRC_04	STY 78
	CMP #30
	BCS &PRC_06
	LDA #CD
	STA 74
	LDA #98
	STA 75
	JMP &PRC_05
&PRC_06	SBC #30
	TAY
	LDA :CHAR_ADDRLO,Y
	STA 74
	LDA :CHAR_ADDRHI,Y
	STA 75
&PRC_05	STX 72
	LDA :KEY_BIT,X
	STA 73
	LDX #04
&PRC_02	LDY :SOFS,X
	LDA (74),Y
	AND 73
	BEQ &PRC_01
	LDA BE4D,Y
	ORA #01
	STA BE4D,Y
&PRC_01	DEX
	BPL &PRC_02
	RTS


'X=XPOS(0-39)
'Y=YPOS(0-195)
'A=CHAR(32 OR 48-?)
'MEMORY USED: ?
'&PLOT_CHAR
'	PHA
'	JSR &CALC_SLOC
'	PLA
'	CMP #30
'	BCS &PCH_01
'	LDA #CD
'	STA 66
'	LDA #98
'	STA 67
'	JMP &PCH_02
'&PCH_01	SEC
'	SBC #30
'	TAY
'	LDA :CHAR_ADDRLO,Y
'	STA 66
'	LDA :CHAR_ADDRHI,Y
'	STA 67
'&PCH_02	LDX #04
'&PCH_03	LDY :SOFS,X
'	LDA (66),Y
'	STA (64),Y
'	DEX
'	BPL &PCH_03
'	RTS



'X=X-POSITION (0-39)
'Y=Y-POSITION (0-195)
'A=MESSAGE NUMBER

&PLOT_MESSAGE
	PHA
	JSR &CALC_SLOC
	PLA
	TAX	'GET MESSAGE ADDRESS
	JSR &GET_MESSADDRESS
	LDY #00
	STY 68
&PM_05	LDY 68
	LDA (62),Y
	CMP #"!"
	BEQ &PM_04
	CMP #30
	BCS &PM_01
	LDA #CD
	STA 66
	LDA #98
	STA 67
	JMP &PM_02
&PM_01	SEC
	SBC #30
	TAY
	LDA :CHAR_ADDRLO,Y
	STA 66
	LDA :CHAR_ADDRHI,Y
	STA 67
&PM_02	LDX #04
&PM_03	LDY :SOFS,X
	LDA (66),Y
	STA (64),Y
	DEX
	BPL &PM_03
	INC 64
	BNE 02
	INC 65
	INC 68
	JMP &PM_05
&PM_04	RTS


'X=XPOS(0-39)
'Y=YPOS(0-199)
&CALC_SLOC
	STX 60
	TYA	'CALC YLOC
	LDY #00
	STY 61
	ASL
	ROL 61
	ASL
	ROL 61
	ASL
	ROL 61
	STA 64
	LDA 61
	STA 65
	LDA 64
	ASL
	ROL 61
	ASL
	ROL 61
	ADC 64
	STA 64
	LDA 61
	ADC 65
	TAX
	LDA 60
	ADC 64
	STA 64
	TXA
	ADC #A0
	STA 65
	RTS

'X=MESSAGE NUMBER
&GET_MESSADDRESS
	LDA :MESSAGE_VECTORLO,X
	STA 62
	LDA :MESSAGE_VECTORHI,X
	STA 63
	RTS

&INIT_6522
	SEI
	LDA #$247
	STA 0302	'SET DDRB TO ALL OUT EXCEPT B3 (KEY BIT)
	LDA #$255
	STA 0303  'SET DDRA TO ALL OUT
	LDA #7F	'DISABLE ALL IRQ'S
	STA 030E
'	LDA #C0	'ENABLE JUST T1 IRQ
'	STA 030E
	LDA #40   'SET T1 MODE TO CONTINUOUS IRQ'S
	STA 030B
	LDA #10   'SET T1 LATCH TO 10,000
	STA 0306
	LDA #27
	STA 0307
	LDA #DD
	STA 030C
	RTS







'F0-F7= NEW SCORE DATA
'A   = HISCORE ENTRY
&INSERT_HISCORE
	ASL
	ASL
	ASL
	STA F8
	LDX #$151
	LDY #$159
&IHS_01	LDA 1F00,X
	STA 1F00,Y
	CPX #00
	BEQ &IHS_03
	DEX
	DEY
	CPX F8
	BCS &IHS_01
&IHS_03	LDY F8
	LDX #00
&IHS_02	LDA F0,X
	STA 1F00,Y
	INY
	INX
	CPX #08
	BCC &IHS_02
	LDX #00	'VALIDATE CHARACTER PORTION OF TABLE
	CLC
&IHS_04	LDA #20
	LDY 1F00,X
	BNE 03
	STA 1F00,X
	LDY 1F01,X
	BNE 03
	STA 1F01,X
	LDY 1F02,X
	BNE 03
	STA 1F02,X
	LDY 1F03,X
	BNE 03
	STA 1F03,X
	TXA
	ADC #08
	TAX
	CPX #$160
	BCC &IHS_04
	RTS




&CHECK_HIGH_SCORE
	LDA C0,X
	BNE &CHS_03
	LDA C1,X
	BNE &CHS_03
	LDA C2,X
	BEQ &CHS_02
&CHS_03	LDA C0,X
	STA F4
	LDA C1,X
	STA F5
	LDA C2,X
	STA F6
	STX F3
	JSR &FIND_HISCORE
	BCC &CHS_02	'NO HISCORE
	STX ;HS_ENTRY	'=0-19
	LDX #$23
	LDA F3	'3=P2 0=P1 CALC AND STORE PLAYER NUMBER IN MSG
	PHA
	LSR
	CLC
	ADC #01
	ORA #30
	STA :HS_MESSAGE,X
	JSR &INPUT_NAME
	LDX #03
&CHS_01	LDA :HS_INPUT,X
	STA F0,X
	DEX
	BPL &CHS_01
	LDA ;ORIGINAL_DIFFICULTY	'STORE DIFFICULTY
	STA F7
	PLA
	TAX
	LDA C0,X
	STA F4
	LDA C1,X
	STA F5
	LDA C2,X
	STA F6
	LDA ;HS_ENTRY
	JSR &INSERT_HISCORE
	JSR &SAVE_HISCORE
	JSR &WIPE_ARENA
&CHS_02	RTS


'F4-F6=SCORE F4 IS LOW
'CARRY SET IF HISCORE FOUND
&FIND_HISCORE
	LDX #00
&FHS_01	TXA
	ASL
	ASL
	ASL
	TAY
	LDA ;ORIGINAL_DIFFICULTY
	CMP 1F07,Y
	BCC &FHS_NO
	BNE &FHS_YES
'SAME, SO CHECK VALUE
	LDA F6
	CMP 1F06,Y
	BCC &FHS_NO
	BNE &FHS_YES
	LDA F5
	CMP 1F05,Y
	BCC &FHS_NO
	BNE &FHS_YES
	LDA F4
	CMP 1F04,Y
	BCC &FHS_NO
&FHS_YES  SEC
	RTS
&FHS_NO	INX
	CPX #$20
	BCC &FHS_01
	CLC
	RTS

&DISPLAY_HISCORES
	LDA #00
	STA F0
	LDA #1E
	STA F1
	LDX #$00
&DHS_02	LDY #$17
&DHS_01	LDA (F0),Y
	STY EF
	INY
	JSR &PLOT_CHAR
	LDY EF
	DEY
	BPL &DHS_01
	LDA #$18
	JSR &ADD_F0
	INX
	CPX #$14
	BCC &DHS_02
&DHS_03	JSR &CLEAR_KBDBUFFER
&DHS_04	JSR &MANAGE_SCROLLER
	LDA BF
	BEQ &DHS_04	'WAIT FOR INPUT
	PHA
	JSR &WIPE_ARENA
	PLA
	CMP #05
	BEQ 02
	SEC
	RTS
	CLC
	RTS



'0-7
'8-15
'16-23
'24-31
'32-39
'40-47
'48-55
'56-63
'64-71
'72-79
'
'80-87
'88-95
'96-103
'104-111
'112-119
'120-127
'128-135
'136-143
'144-151
'152-159

&POPULATE_HOS
	LDX #$17
&PHOS_01	LDA :HOS_TEXT,X
	STA 1E00,X
	DEX
	BPL &PHOS_01
	LDX #$10
	JMP &GENERAL_POP
&POPULATE_HOF
	LDX #$17
&PHOF_01	LDA :HOF_TEXT,X
	STA 1E00,X
	DEX
	BPL &PHOF_01
	LDX #00
&GENERAL_POP
	LDA #00
	STA EF
	LDA #$10
	STA F3
&PHOF_04	STX F0
	LDA EF
	ASL
	STA F1
	ASL
	ASL
	ASL
	ADC F1
	TAY
	TXA
	ASL
	ASL
	ASL
	TAX
	LDA 1F00,X
	STA 1E24,Y
	LDA 1F01,X
	STA 1E25,Y
	LDA 1F02,X
	STA 1E26,Y
	LDA 1F03,X
	STA 1E27,Y
	LDA 1F07,X
	ASL
	ASL
	ASL
	STX F2
	TAX
&PHOF_02	LDA :DIFFICULTY_TEXT,X
	STA 1E2A,Y
	INY
	INX
	TXA
	AND #03
	BNE &PHOF_02
	INY
	LDX F2
	LDA #03
	STA F2
	INX
	INX
&PHOF_03	LDA 1F04,X
	LSR
	LSR
	LSR
	LSR
	ORA #30
	STA 1E2B,Y
	LDA 1F04,X
	AND #0F
	ORA #30
	STA 1E2C,Y
	INY
	INY
	DEX
	DEC F2
	BNE &PHOF_03
	INC EF
	LDX F0
	INX
	DEC F3
	BNE &PHOF_04
	RTS

'252 BYTES ~ 2E00
'["   HALL OF FAME   "]
'["                  "]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["????==<<<<==000000"]
'["                  "]
'["    PRESS FIRE    "]
&PLOT_HSENTRY_SCRN
	LDX #$49
	JSR &PTIT_03
	LDX #03
	LDY #$51
	LDA ;HS_ENTRY
	CMP #$10
	LDA #$10
	BCS 02
	LDA #$09
	JSR &PLOT_MESSAGE
	LDA ;HS_ENTRY
	CMP #$10
	BCC 02
	SBC #$10
	CLC
	STA F0
	ADC #01
	LDX #$01
	LDY #$15
	JSR &PLOT_DECIMAL
	LDA F0
	CMP #03
	BCC 02
	LDA #03
	ASL
	TAX
	LDA :EXTENSION_TEXT,X
	STX F1
	LDX #$01
	LDY #$17
	JSR &PLOT_CHAR
	LDX F1
	INX
	LDA :EXTENSION_TEXT,X
	LDY #$18
	LDX #$01
	JSR &PLOT_CHAR
	LDA F0
	CMP #$10
	BCS &PHSS_01
	LDA #" "
	LDY #$15
	LDX #$01
	JMP &PLOT_CHAR
&PHSS_01	RTS

&INPUT_NAME
	JSR &PLOT_HSENTRY_SCRN
	LDA #06
	LDX #04
&HSIN_06	LDY :SOFS,X
	STA A80D,Y
	DEX
	BPL &HSIN_06
	LDX #03
	LDA #$32
&HSIN_01	STA :HS_INPUT,X
	DEX
	BPL &HSIN_01
	LDA #00
	STA ;HSNAME_POSITION
	LDA #$38
	STA ;HS_CURRENT_CHAR
	LDA #01
	STA ;SCROLL_FLAG
	LDA #$100
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	LDX #04
	JSR &SETUP_MSCROLL


&HSIN_02	LDA ;HS_CURRENT_CHAR
	LDX ;HSNAME_POSITION
	CMP #$26	'CURRENT CHAR IS ONLY 0-39, WE NEED TO KNOW ACTUAL!
	BCS &HSIN_04
	ADC #$65
	JMP &HSIN_03
&HSIN_04	CMP #$36
	BCS &HSIN_05
	ADC #$22
	JMP &HSIN_03
&HSIN_05	ADC #$23
&HSIN_03	STA :HS_INPUT,X
	JSR &HSPLOT_NAME
	JSR &HSPLOT_CURSORS
	JSR &HS_CONTROLKEY
	BCC &HSIN_02
	LDA ;CHEAT_CHECK
	BPL &LCF_04	'CHEAT ACTIVE, SO LOOK FOR LVxx
	LDX #03
&LCF_02	LDA :HS_INPUT,X
	EOR ;CHEAT_CHECK	'INITIALLY FF
	CMP :ACTIVATE_TEXT,X	' TFF'
	BNE &LCF_03
	DEX
	BPL &LCF_02
	LSR ;CHEAT_CHECK	'ACTIVATE CHEAT MODE
	JSR &WHITE_ARENA
	LDA #05
	JSR &RUNTIME_DELAY
	JSR &BLACK_ARENA
	LDA #10	'SOUND IT OUT
	STA BFE0
	JSR &CLEAR_ENTRY
	JMP &HSIN_02
&LCF_03	RTS
&LCF_04	LDX #00		'CHEAT ACTIVE, NOW CHECK FOR 'LV'
	LDA :HS_INPUT,X
	CMP #"L"
	BNE &LCF_03
	INX
	LDA :HS_INPUT,X
	CMP #"V"
	BNE &LCF_03
	INX		'LV DETECTED, SO CHECK LEVEL NUMBER
	LDA :HS_INPUT,X
	SEC
	SBC #$48
	STA F0
	INX
	LDA :HS_INPUT,X
	SBC #$48
	STA F1
	LDA F0
	ASL
	STA F0
	ASL
	ASL
	ADC F0
	ADC F1
	BEQ &LCF_03
	CMP #$49
	BCS &LCF_03
	STA ;START_LEVEL
	JSR &WHITE_ARENA
	LDA #03
	JSR &RUNTIME_DELAY
	JSR &BLACK_ARENA
	LDA #11
	STA BFE0
	JSR &CLEAR_ENTRY
	JSR &CLEAR_MESSAGE
	LDX #$11
	JSR &SETUP_MSCROLL
	JMP &HSIN_02

&CLEAR_ENTRY
	LDX #03	'CLEAR HISCORE NAME
	LDA #20
&LCF_01	STA :HS_INPUT,X
	DEX
	BPL &LCF_01
	LDA #00	'RESET CURSOR POSITION
	STA ;HSNAME_POSITION
	LDA #$39	'SET CURRENT CHAR
	STA ;HS_CURRENT_CHAR
	RTS



'" TFF" to access level codes
'then "LVxx" to access a starting level.



&HSPLOT_CURSORS
	LDX #00
	LDA ;HS_CURRENT_CHAR
	CMP #$20
	BCC &HSPC_01
	SBC #$20
	LDX #$240
&HSPC_01	STX F0
	CLC
	ADC F0
	STA F0
	LDA #AA
	ADC #00
	STA F1
	LDA F0
	ADC #CA
	STA F0
	BCC 02
	INC F1
	LDX #$04
&HSPC_02	LDY :SOFS,X
	LDA (F0),Y
	ORA #80
	STA (F0),Y
	DEX
	BPL &HSPC_02
	LDX ;HSNAME_POSITION
	LDA #%01111110
	STA AE91,X
	RTS


&HSDELETE_CURSORS
	LDX #00
	LDA ;HS_CURRENT_CHAR
	CMP #$20
	BCC &HSDC_01
	SBC #$20
	LDX #$240
&HSDC_01	STX F0
	CLC
	ADC F0
	STA F0
	LDA #AA
	ADC #00
	STA F1
	LDA F0
	ADC #CA
	STA F0
	BCC 02
	INC F1
	LDX #$04
&HSDC_02	LDY :SOFS,X
	LDA (F0),Y
	AND #7F
	STA (F0),Y
	DEX
	BPL &HSDC_02
	LDX ;HSNAME_POSITION
	LDA #%01000000
	STA AE91,X
	RTS


&HSPLOT_NAME
	LDY #$07
	LDX #00
&HSPN_01	LDA :HS_INPUT,X
	STX F0
	LDX #07
	JSR &PLOT_CHAR
	LDX F0
	INY
	INX
	CPX #$04
	BCC &HSPN_01
	RTS

&HS_HIGHLIGHTCURSOR
	DEC ;SLOW_DELAY
	BNE &HSHC_01
	LDX ;HS_COLOUR
	INX
	CPX #$12
	BCC 02
	LDX #$00
	STX ;HS_COLOUR
	LDA :COLOUR_FADE,X
	STA AE90
	LDA #06
	STA AE98
&HSHC_01	RTS

&HS_HIGHLIGHTPOSITION
	LDA ;SLOW_DELAY
	LSR
	LSR
	LSR
	LSR
	LSR
	LDX #$04
&HSZZ_01	LDY :SOFS,X
	STA A7FA,Y
	ADC #01
	AND #07
	DEX
	BPL &HSZZ_01
	RTS

&HSCK_10	CMP #00
	BEQ &HS_CONTROLKEY
	LDX ;REPEAT_FLAG
	BNE &HSCK_12
	DEC ;HS_DELAY
	BNE &HS_CONTROLKEY
	INC ;REPEAT_FLAG
	LDX #$20
	STX ;HS_DELAY
	JMP &HSCK_11
&HSCK_12  DEC ;HS_RPTCNT
	BNE &HS_CONTROLKEY
	LDX #$01
	STX ;HS_RPTCNT
	JMP &HSCK_11

&HS_CONTROLKEY
	JSR &MANAGE_SCROLLER
	JSR &HS_HIGHLIGHTPOSITION
	JSR &HS_HIGHLIGHTCURSOR
	DEC ;HS_KEYDELAY
	BPL &HS_CONTROLKEY
	LDA #7F
	STA ;HS_KEYDELAY
	LDA BF
	CMP ;OLD_KEY
	BEQ &HSCK_10
	STA ;OLD_KEY
	LDX #$20
	STX ;HS_DELAY
	LDX #$01
	STX ;HS_RPTCNT
	LDX #00
	STX ;REPEAT_FLAG
	CMP #00
	BEQ &HS_CONTROLKEY 'LOOP ON NO KEY
&HSCK_11	PHA
	JSR &HSDELETE_CURSORS
	PLA
	AND #01
	BEQ &HSCK_01
'LEFT - SELECT CHARACTER LEFT
	LDX ;HS_CURRENT_CHAR
	DEX
	BPL 02
	LDX #$39
	STX ;HS_CURRENT_CHAR
	LDA #01
	STA BFE0
&HSCK_06	CLC
	RTS
&HSCK_01  LDA BF
	AND #02
	BEQ &HSCK_02
'RIGHT - SELECT CHARACTER RIGHT
	LDX ;HS_CURRENT_CHAR
	INX
	CPX #$40
	BCC 02
	LDX #00
	STX ;HS_CURRENT_CHAR
	LDA #$01
	STA BFE0
&HSCK_07	CLC
	RTS
&HSCK_02	LDA BF
	AND #04
	BEQ &HSCK_03
'FIRE - NEXT POSITION
	LDX ;HSNAME_POSITION
	CPX #$03
	BCS &HSCK_08
	INC ;HSNAME_POSITION
	LDA #04
	STA BFE0
&HSCK_08	CLC
	RTS
&HSCK_03	LDA BF
	AND #08
	BEQ &HSCK_04
'DEL - BACKSPACE
	LDA ;HSNAME_POSITION
	BEQ &HSCK_05
	DEC ;HSNAME_POSITION
	LDA #02
	STA BFE0
&HSCK_05	CLC
	RTS
&HSCK_04	LDA BF
	AND #10
	BEQ &HSCK_05
'ESC - END!
	SEC
	RTS



&SSCROLL_DRIVER
	JSR &SSCROLL_INIT
&SSDV_01	DEC ;SCROLL_DELAY
	BPL &SSDV_04
	LDA ;SD_REF
	STA ;SCROLL_DELAY
	JSR SSCROLL_DISPLAYLINE
	INC ;SS_EVENLINE
	JSR &SSCROLL_UP
	JMP &SSDV_05
&SSDV_04	LDY #$189
&SSDV_07	LDX #$42
&SSDV_10	DEX
	BNE &SSDV_10
	DEY
	BNE &SSDV_07
&SSDV_05	JSR &CYCLIC_COLOURS
	JSR &MSC_02	'MANAGE SCROLLER (BUT NOT COLOURS)
	LDA BF
	CMP #01	'P TO PAUSE
	BNE &SSDV_03
	LDA ;SS_EVENLINE	'DON'T PAUSE UNLESS ON ODD LINE
	LSR                 '(FORCE CORRECT COLOURS)
	BCC &SSDV_01
	LDA ;SD_REF
	EOR #01
	STA ;SD_REF
	JSR &CLEAR_KBDBUFFER
	JMP &SSDV_01
&SSDV_03	CMP #05	'FIRE TO QUIT
	BNE &SSDV_01
&SSDV_09	JSR &WIPE_ARENA
	JSR &CLEAR_KBDBUFFER
	LDA #$100
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	JMP &PCHS_01


&CLEAR_KBDBUFFER
	LDA BF
	BNE &CLEAR_KBDBUFFER
	RTS

&SSCROLL_INIT
	LDA #00
	STA ;SS_EVENLINE
	LDA #08
	STA ;XTRA_SLOW
	JSR &WIPE_ARENA
	JSR &CLEAR_MESSAGE
	LDX #08
	LDA :MESSAGE_VECTORLO,X
	STA E0
	LDA :MESSAGE_VECTORHI,X
	STA E1
	LDA #00
	STA E4
	LDA #01
	STA ;SCROLL_FLAG
	LDA #$01
	STA ;SCROLL_CNT
	STA ;SCROLL_REF
	LDX #07
	JMP &SETUP_MSCROLL

&SSDL_03	INY
	STY E5
	LDA #40
&SSDL_05	STA B772,Y
	INY
	CPY #$20
	BCC &SSDL_05
	JMP &SSDL_04


&SSCROLL_DISPLAYLINE	'DISPLAY PIXEL ROW
	LDY #$00
&SSDL_01	LDA (E0),Y
	CMP #"!"
	BEQ &SSDL_03
	CMP #"-"
	BEQ &SSDL_06
	CMP #"@"
	BEQ &SSDL_07
	STY E5
	JSR &SSPC_02
	LDY E5
&SSDL_06	INY
	STY E5
	CPY #$20
	BCC &SSDL_01
&SSDL_04	INC E4
	LDA E4
	CMP #06
	BCC &SSDL_02
	LDA #00
	STA E4
	LDA E0
	CLC
	ADC E5
	STA E0
	BCC 02
	INC E1
	RTS
&SSDL_07  LDX #08
          LDA :MESSAGE_VECTORLO,X
          STA E0
          LDA :MESSAGE_VECTORHI,X
          STA E1
&SSDL_02	RTS


&SSPC_ALIEN2
	LDY E4
	LDX :SOFS,Y
	LDY E5
	LDA 9BE8,X
	STA B772,Y
	RTS

&SSPC_ALIENS
	CMP #$58
	BNE &SSPC_ALIEN2
	LDY E4
	LDX :SOFS,Y
	LDY E5
	LDA 98C8,X
	STA B772,Y
	RTS


&SSPC_NORMAL
	SEC
	SBC #30
	TAY
	LDA :CHAR_ADDRLO,Y
	STA F4
	LDA :CHAR_ADDRHI,Y
	STA F5
	LDX E4	 'YPOS IN CHAR
	LDY :SOFS,X
	LDA (F4),Y 'CHAR BASE, SO A NOW CONTAIN ACTUAL DISPLAY VALUE
	LDY E5
	STA B772,Y	'STORE BYTE TO SCRN
	RTS
&SSPC_03	LDA #40
	LDY E5
	STA B772,Y	'STORE BYTE TO SCRN
	RTS

&SSPC_02		'PRESERVE Y
	LDY E4
	CPY #05
	BEQ &SSPC_03	'ON LINE SEPERATOR, SO 64
&SSPC_04	CMP #$36
	BCC &SSPC_03
	CMP #"."
	BEQ &SSPC_RESET
	BCC &SSPC_COLOUR
	CMP #"3"
	BCC &SSPC_NORMAL
	CMP #$58
	BCC &SSPC_BONUS
	CMP #$60
	BCC &SSPC_ALIENS
	CMP #$97
	BCC &SSPC_NORMAL
	CMP #$101
	BCC &SSPC_BAT
'MUST NOW BE TILES
	SBC #$102
	ASL
	STA F4
	LDA #98
	STA F5
	LDX E4
	LDY :SOFS,X
	LDA (F4),Y
	LDX E5
	STA B772,X
	INY
	LDA (F4),Y
	STA B773,X
	RTS
&SSPC_RESET
	LDA #06
	LDX E5
	STA B772,X
	RTS
&SSPC_COLOUR
	SEC
	SBC #$36
	ASL
	STA F4
	ASL
	ADC F4
	ADC E4
	TAX
	LDA :INST_COLOURBLOCKS,X
	LDY E5
	STA B772,Y
	RTS
&SSPC_BONUS
	SEC
	SBC #"3"
	ADC #DF	'BONUS BASE LOC LO
	STA F4
	LDA #98	'BONUS BASE LOC HI
	STA F5
	LDX E4
	LDY :SOFS,X
	LDA (F4),Y
	LDY E5
	STA B772,Y
	RTS
&SSPC_BAT		'NORMAL BAT
	CMP #$97
	BNE &SSPC_BT2
	LDY E4
	LDX :SOFS,Y
	LDY E5
	LDA 9990,X
	STA B772,Y
	LDA 9991,X
	STA B773,Y
	LDA 9992,X
	STA B774,Y
	LDA 9993,X
	STA B775,Y
	RTS
&SSPC_BT2		'WIDE BAT
	CMP #$99
	BNE &SSPC_BT3
	LDY E4
	LDX :SOFS,Y
	LDY E5
	LDA 9B20,X
	STA B772,Y
	LDA 9B21,X
	STA B773,Y
	LDA 9B22,X
	STA B774,Y
	LDA 9B23,X
	STA B775,Y
	LDA 9B24,X
	STA B776,Y
	LDA 9B25,X
	STA B777,Y
	RTS
&SSPC_BT3		'EAT BAT
	BCS &SSPC_BT4
	LDY E4
	LDX :SOFS,Y
	LDY E5
	LDA 9A58,X
	STA B772,Y
	LDA 9A59,X
	STA B773,Y
	LDA 9A5A,X
	STA B774,Y
	LDA 9A5B,X
	STA B775,Y
	RTS
&SSPC_BT4    	'PULSOID
	RTS



&SSCROLL_UP
	LDA #5A
	STA F2
	LDA #82
	STA F0
	LDA #A2
	STA F1
	STA F3
	CLC
	LDX #$136	'B79A-A25A
&SSU_03	LDY #$19
&SSU_02	LDA (F0),Y
&SSU_01	STA (F2),Y
	DEY
	BPL &SSU_02
	LDA F0
	ADC #28
	STA F0
	BCC 03
	INC F1
	CLC
	LDA F2
	ADC #28
	STA F2
	BCC 03
	INC F3
	CLC
	DEX
	BNE &SSU_03
	RTS

&DETECT_SYSTEM
	SEI
	LDX 032C
	BEQ 02
	LDX #10	'Oric Atmos
	STX ;OPERATING_SYSTEM
	CLI
	RTS
~END
